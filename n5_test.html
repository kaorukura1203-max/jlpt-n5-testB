<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>JLPT N5 æ–‡æ³•ãƒ†ã‚¹ãƒˆï¼ˆ40å•ï¼‰ï¼‹å¼±ç‚¹åˆ†æ</title>
<style>
  body{font-family:sans-serif;padding:20px;max-width:900px;margin:0 auto;background:#ffd6e5;}
  .muted{color:#666}
  .choice{border:1px solid #cfe4f2;;padding:10px;margin:6px 0;cursor:pointer;border-radius:8px}
  .choice.selected{background:#d0f0ff}
  .choice {
  border: 2px solid #7fbcd2;
  background: #eef8fd;}
  .choice:hover {
  background: #dff2fb;}
  .choice.selected {
  background: #bfe7f8;
  border-color: #2fa4d9;}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .pill{display:inline-block;border:1px solid #999;padding:4px 10px;border-radius:999px;font-size:12px}
  /* button{margin-top:14px;padding:10px 18px;font-size:14px} */
  button[disabled]{opacity:.5;cursor:not-allowed}
  #next[disabled]{opacity:1;background:#eee;color:#999;border:1px solid #ccc;cursor:not-allowed;}
  hr{margin:18px 0}
  .card{border:1px solid #ddd;border-radius:12px;padding:14px;margin:10px 0}
  .h2{font-size:18px;margin:0 0 8px}
  .h3{font-size:13px;margin:0 0 4px}
  .kpi{font-size:18px;font-weight:600}
  .bad{color:#b00020}
  .good{color:#0b6b2a}
  .warn{color:#8a5a00}
  .list{margin:6px 0 0 18px}
  .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  .score-bar{
    width:160px;
    height:8px;
    background:#eee;
    border-radius:4px;
    margin-top:6px; 
  }

  #lang-select button {
    font-size: 16px;
    padding: 6px 12px;
}  
  /* ===== ãƒ­ã‚´è¿½åŠ  ===== */
  #logo{
    height:60px;
    width: auto;
}
  
  @media (max-width: 600px) {
    #logo {
      height: 50px;
    }
}

/* ===== è©•ä¾¡è¡¨ç¤º ===== */
  .overall{
  font-size:16px;
  font-weight:600;
  margin-top:8px;
}

  .score-bar-fill{
    height:100%;
    /* background:#f0a060; */
    border-radius:4px;
 }
 
  .cat{
    display:flex;
    align-items:center;
    gap:8px;
    margin:6px 0;
 }
  .cat span{
    width:120px;
 }
  .bar{
    flex:1;
    height:8px;
    background:#eee;
    border-radius:4px;
 }
  .fill{
    height:100%;
    background:#f0a060;
    border-radius:4px;
 }
 .pct{
    width:40px;
    text-align:right;
    font-size:12px;
    color:#666;
  } 
  /* ===== 3è‰²ãƒ«ãƒ¼ãƒ«ï¼ˆå…±é€šå®šç¾©ï¼‰ =====
   low  : 0â€“29%
   mid  : 30â€“64%
   high : 65â€“100%
*/
.fill.low,
.score-bar-fill.low {
  background:#d9534f; /* èµ¤ */
}

.fill.mid,
.score-bar-fill.mid {
  background:#f0a060; /* æ©™ */
}

.fill.high,
.score-bar-fill.high {
  background:#5cb85c; /* ç·‘ */
}

/* è¨ºæ–­çµæœï¼šã‚°ãƒ«ãƒ¼ãƒ—åã‚’å¼·åˆ¶çš„ã«å°ã•ãã™ã‚‹ */
#resultView h3{
  font-size:12px !important;
  margin:4px 0 !important;
  font-weight:600;
}
/* è¨ºæ–­çµæœï¼šæ¨ªãƒãƒ¼å·¦ã®ã‚°ãƒ«ãƒ¼ãƒ—åï¼ˆPARTICLEãªã©ï¼‰ */
#resultView .cat > span:first-child{
  font-size:12px !important;
  font-weight:500;
}

/* å¼·åŒ–ç·´ç¿’ï¼šå•é¡Œæ•°ã¯10å•ã®ã¿è¡¨ç¤º */
label:has(input[name="practiceCount"][value="20"]),
label:has(input[name="practiceCount"][value="30"]) {
  display: none;
}
#next[disabled]{
  opacity: 1 !important;
  color: #666 !important;
  background: #eee !important;
  border: 1px solid #ccc !important;
}

#btnB { display: none; }

/* â˜… ã“ã“ã‹ã‚‰è¿½åŠ  â˜… */
#features li {
  margin-bottom: 12px;
}

#features li span {
  display: block;
  margin-top: 4px;
  line-height: 1.6;
}
/* â˜… ã“ã“ã¾ã§è¿½åŠ  â˜… */
/* â˜… ã“ã“ã¾ã§è¿½åŠ  â˜… */

/* â˜… ã‚¯ãƒªãƒƒã‚¯ä¸èƒ½å¯¾ç­–ï¼ˆè¿½åŠ ï¼‰ */
#testView {
  position: relative;
  z-index: 1;
}

.choice {
  pointer-events: auto;
}
/* ===== Languageï¼ˆè¨­å®šãƒœã‚¿ãƒ³ï¼šA/Cã¨å®Œå…¨ã«åˆ†é›¢ï¼‰===== */
#lang-select button{
  background:#f2f2f2 !important;
  color:#333 !important;
  border:1px solid #aaa;
  border-radius:8px;
  padding:6px 12px;
  font-size:15px;
  font-weight:400;
  cursor:pointer;
}

/* hover ã‚‚æ§ãˆã‚ */
#lang-select button:hover{
  background:#e6e6e6 !important;
}

/* ===== ãƒ¡ã‚¤ãƒ³ãƒœã‚¿ãƒ³ï¼ˆå½¹å‰²ãŒé•ã†ã®ã§åˆ¥è‰²ï¼‰===== */
#goMain{
  background:#ff7aa2 !important;
  color:#fff !important;
  border:none;
  border-radius:10px;
  padding:6px 14px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}

#goMain:hover{
  background:#ff5f8f !important;
}

/* ===== ã‚¹ãƒãƒ›å¯¾ç­– ===== */
@media (max-width:480px){
  #lang-select button{
    font-size:16px;
    padding:8px 14px;
  }
}

/* âœ… ã“ã“ã‚’è¿½åŠ ï¼šgoMainã ã‘ã¯æœ€çµ‚çš„ã«ãƒ”ãƒ³ã‚¯ã§ç¢ºå®šã•ã›ã‚‹ï¼ˆå‰Šé™¤ãªã—ï¼‰ */
#lang-select #goMain{
  background:#ff7aa2 !important;
  color:#fff !important;
}
#lang-select #goMain:hover{
  background:#ff5f8f !important;
}

/* ===== A / C ãƒœã‚¿ãƒ³è‰²ï¼ˆè¿½åŠ ï¼šä¸Šæ›¸ãã®ã¿ãƒ»å‰Šé™¤ãªã—ï¼‰===== */
/* Aï¼šãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ï¼ˆåˆ¥è‰²ï¼‰ */
#btnA{
  background:#6fa8dc !important;
  color:#fff !important;
}
#btnA:hover{
  background:#5b96cc !important;
}

/* Cï¼šå¼·åŒ–ç·´ç¿’ï¼ˆåˆ¥è‰²ï¼‰ */
#btnC{
  background:#7bc8a4 !important;
  color:#fff !important;
}
#btnC:hover{
  background:#66b892 !important;
}
#btnC:hover{
  background:#66b892 !important;
}
#next{
  font-size: 16px;
  padding: 12px 20px;
}
/* ===== è©•ä¾¡ãƒ†ã‚­ã‚¹ãƒˆç”¨ãƒãƒ¼ã‚¯ ===== */
p.high::before{
  content:"ğŸŒ¸ ";
}
p.mid::before{
  content:"âš ï¸ ";
}
p.low::before{
  content:"â— ";
}
</style>
</head>

<body>
  

  <!-- è¨€èªåˆ‡ã‚Šæ›¿ãˆ -->
  <div id="lang-select" style="margin-bottom:12px;">
    ğŸŒ Languageï¼š
    <button id="btn-ja">æ—¥æœ¬èª</button>
    <button id="btn-en">English</button>
    <button id="btn-de">Deutsch</button>
    <button id="btn-ko">í•œêµ­ì–´</button>

    
    <button id="goMain">ãƒ¡ã‚¤ãƒ³</button>
  </div>
  
  
<div id="page1">
  <!-- èª¬æ˜æ–‡ -->
  <h1 id="title" style="display:flex; align-items:center; gap:12px;">
    <span id="titleText">JLPT N5å¯¾ç­–ã‚¢ãƒ—ãƒª</span>
    <img id="logo" src="logo.png" alt="Academy Logo">
  </h1>

  <p id="intro">
    ã“ã‚“ã«ã¡ã¯ï¼<br>
    ã“ã®ã‚¢ãƒ—ãƒªã¯ã€JLPT N5ã®æ–‡æ³•ã‚’ ã¹ã‚“ãã‚‡ã†ã™ã‚‹ ã‚¢ãƒ—ãƒªã§ã™ã€‚
  </p>

  <p id="what">
    ã“ã®ã‚¢ãƒ—ãƒªã§ã¯ã€ã¤ãã® 3ã¤ ãŒ ã§ãã¾ã™ã€‚
  </p>
  
  <ul id="features">
    <li><strong>Aï¼šãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯</strong> <span class="en">(Level Check)</span><br>
      <span id="featA">ã„ã¾ã® æ—¥æœ¬èªãƒ¬ãƒ™ãƒ«ã‚’ ã—ã‚‰ã¹ã¾ã™ã€‚</span>
    </li>
    <li><strong>Bï¼šå¼±ç‚¹åˆ†æ</strong> <span class="en">(Weakness Analysis)</span><br>
      <span id="featB">ã«ãŒã¦ãª æ–‡æ³•ãŒ ã‚ã‹ã‚Šã¾ã™ã€‚</span>
    </li>
    <li><strong>Cï¼šå¼·åŒ–ç·´ç¿’</strong> <span class="en">(Intensive Practice)</span><br>
      <span id="featC">ã«ãŒã¦ãª æ–‡æ³•ã‚’ ãŸãã•ã‚“ ã‚Œã‚“ã—ã‚…ã†ã—ã¾ã™ã€‚</span>
    </li>
  </ul>
  
  <p id="recommend">
    ã¯ã˜ã‚ã¦ã®äººã¯ã€<strong>Aï¼ˆãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ï¼‰</strong>ã‹ã‚‰ ã¯ã˜ã‚ã¦ãã ã•ã„ã€‚
  </p>
  
  <!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <div id="menu" style="margin:16px 0;">
   <button id="btnA">[ A ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ ]</button>
   <button id="btnB">[ B å¼±ç‚¹åˆ†æ ]</button>
   <button id="btnC">[ C å¼·åŒ–ç·´ç¿’ ]</button>
 </div>
</div>
  
<div id="page2" style="display:none;">

    <h2 id="about">ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ã«ã¤ã„ã¦</h2>
  
    <ul id="rule">
      <li id="rule1">ã‚‚ã‚“ã ã„ã¯ <strong>40å•</strong> ã‚ã‚Šã¾ã™ã€‚</li>
      <li id="rule2">æ–‡ã‚’ ã‚ˆã‚“ã§ã€ï¼ˆã€€ï¼‰ã‚„ï¼ˆâ˜…ï¼‰ã« ã¯ã„ã‚‹ ã„ã¡ã°ã‚“ ã„ã„ ã“ã¨ã°ã‚’ ãˆã‚‰ã³ã¾ã™ã€‚</li>
      <li id="rule3">ãˆã‚‰ã¶ ã“ã¨ã°ã¯ <strong>4ã¤</strong> ã‚ã‚Šã¾ã™ã€‚</li>
      <li id="rule4">
        ï¼ˆã€€ã€€ï¼‰ã«ï¼ˆâ˜…ï¼‰ãŒ ã‚ã‚‹ ã‚‚ã‚“ã ã„ãŒ ã‚ã‚Šã¾ã™ã€‚
         ã“ã¨ã°ã‚’ ãŸã ã—ã„ ã˜ã‚…ã‚“ã°ã‚“ã« ãªã‚‰ã¹ã¦ã€ï¼ˆâ˜…ï¼‰ã® ã“ã¨ã°ã‚’ ãˆã‚‰ã‚“ã§ãã ã•ã„ã€‚
      </li>
      <li id="rule5">ãˆã‚‰ã°ãªã„ã¨ã€ã¤ãã« ã™ã™ã¿ã¾ã›ã‚“ã€‚</li>
      <li class="note">â€» ã‚‚ã‚“ã ã„ã¯ã€ã¾ãˆã« ã‚‚ã©ã‚‹ã“ã¨ãŒ ã§ãã¾ã›ã‚“ã€‚</li>
    </ul>
  
    <p id="start">
      ã˜ã‚…ã‚“ã³ãŒ ã§ããŸã‚‰ã€ã—ãŸã® ãƒœã‚¿ãƒ³ã‚’ ãŠã—ã¦ãã ã•ã„ã€‚
    </p>
    
    <div id="readyStatus">æº–å‚™OK / Ready</div>

    <button id="toPage3">â–¶ ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ã‚’ã¯ã˜ã‚ã‚‹</button>

</div> <!-- page2 END -->

<div id="practiceSetup" style="display:none;">
  <h2>
    å¼·åŒ–ç·´ç¿’ <span class="muted">(Intensive Practice)</span>
  </h2>

  <p class="muted">
    ã«ãŒã¦ãªæ–‡æ³•ã‚’é›†ä¸­çš„ã«ç·´ç¿’ã—ã¾ã™ã€‚
    <br>
    <span class="muted">Practice your weak grammar points intensively.</span>
  </p>

  <div class="card">
    <label>
      <input type="radio" name="practiceGroup" value="PARTICLE">
      åŠ©è© <span class="muted">(Particles)</span>
    </label><br>

    <label>
      <input type="radio" name="practiceGroup" value="COMMUNICATION">
      ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ–‡æ³• <span class="muted">(Communication Grammar)</span>
    </label><br>

    <label>
      <input type="radio" name="practiceGroup" value="ORDER">
      ä¸¦ã³æ›¿ãˆ <span class="muted">(Word Order)</span>
    </label><br>

    <label>
      <input type="radio" name="practiceGroup" value="BASIC_GRAMMAR">
      åŸºæœ¬æ–‡æ³• <span class="muted">(Basic Grammar)</span>
    </label>
  </div>

  <div class="card">
    <label><input type="radio" name="practiceCount" value="10" checked> 10å•</label>
    <label><input type="radio" name="practiceCount" value="20"> 20å•</label>
    <label><input type="radio" name="practiceCount" value="30"> 30å•</label>
  </div>

  <button id="startPractice">â–¶ å¼·åŒ–ç·´ç¿’ã‚’ã¯ã˜ã‚ã‚‹</button>

  <hr style="margin:20px 0;">

  <div class="card" style="background:#fafafa;">
    <h3 id="appliedTitle" style="margin:0 0 8px;">å¿œç”¨ç·´ç¿’ã«ã¤ã„ã¦</h3>
    <p id="appliedDesc" style="margin:0;font-size:14px;line-height:1.6;">
      çŸ­ã„æ–‡ã—ã‚‡ã†ã‚’ ã‚ˆã¿ã€<br>
      ï¼ˆã€€ã€€ï¼‰ã« å…¥ã‚‹ ã„ã¡ã°ã‚“ ã„ã„ ã“ã¨ã°ã‚’ã€<br>
      ï¼“ã¤ã®ä¸­ã‹ã‚‰ ãˆã‚‰ã³ã¾ã™ã€‚<br><br>
      ã“ã® å¿œç”¨ç·´ç¿’ãŒ ã§ãã‚Œã°ã€<br>
      ã‚ãªãŸã¯ N5ãƒ¬ãƒ™ãƒ«ã® æ–‡æ³•ã‚’ ã‚Šã‹ã„ã—ã¦ã„ã¾ã™ã€‚<br>
      å®‰å¿ƒã—ã¦ã€ã¤ãã« ã™ã™ã‚“ã§ ãã ã•ã„ã€‚
    </p>
    <button id="startAppliedPractice">â–¶ å¿œç”¨ç·´ç¿’ã‚’ã¯ã˜ã‚ã‚‹</button>
  </div>
</div> <!-- practiceSetup END -->

<div id="app">
  <div id="testView" style="display:none;">
    <div class="row" style="justify-content:space-between;">
      <div>
        <div class="pill" id="modePill">ãƒ†ã‚¹ãƒˆ</div>
        <div class="muted" id="status">èª­ã¿è¾¼ã¿ä¸­â€¦</div>
      </div>
      <div class="pill mono" id="progress">-- / --</div>
    </div>

    <hr />

    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <div class="pill" id="groupPill">â€”</div>
        <div class="pill" id="typePill">â€”</div>
      </div>

      <h2 class="h2" id="q">â€”</h2>
      <div id="choices"></div>

      <button id="next" disabled>æ¬¡ã¸</button>

      <div id="mustSelectNote" class="muted" style="margin-top:8px;font-size:12px;">
        â€» é¸æŠã—ãªã„ã¨é€²ã‚ã¾ã›ã‚“ï¼ˆä»•æ§˜ã©ãŠã‚Šï¼‰
      </div>
    </div>
  </div>

   <div id="resultView" style="display:none;"></div>
 </div> <!-- app END -->

<script>
  

/** =========================
 *  è¨­å®šï¼ˆã‚ãªãŸã®ç¢ºå®šæ¡ˆãã®ã¾ã¾ï¼‰
 * ========================= */


const OVERALL_JUDGE = (rate) => {
  if (rate >= 80) return { key: "good", cls: "good" };
  if (rate >= 65) return { key: "warn", cls: "warn" };
  return { key: "bad", cls: "bad" };
};
// â˜…è¨ºæ–­åˆ†æï¼šå¤šè¨€èªæ–‡è¨€ï¼ˆè¨ºæ–­çµæœå°‚ç”¨ï¼‰
const DIAG_TEXT = {
  ja: {
    result: "è¨ºæ–­çµæœ",
    passline: "åˆæ ¼ãƒ©ã‚¤ãƒ³ï¼š65%",
    grammarLevel: "â–¼ æ–‡æ³•ã”ã¨ã®ç†è§£åº¦",
    legend: "è‰²ã®è¦‹æ–¹ï¼šèµ¤ï¼ã«ãŒã¦ï¼æ©™ï¼ã‚‚ã†å°‘ã—ï¼ç·‘ï¼ã§ãã¦ã„ã‚‹",
    review: "â–¼ é–“é•ãˆãŸæ–‡æ³•ï¼ˆå¾©ç¿’ï¼‰",
    retry: "ã‚‚ã†ä¸€å›ã‚„ã‚‹",
    rate: (r,c,t)=>`æ­£è§£ç‡ ${r}%ï¼ˆ${c} / ${t}ï¼‰`,
    levelIntro: "ã¾ã ä¸å®‰å®šã§ã™ã€‚ä»¥ä¸‹ã®ãƒã‚¤ãƒ³ãƒˆã‚’æ„è­˜ã—ã¦å¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚",
    
    test: "ãƒ†ã‚¹ãƒˆ",
    perfect: "Perfect!",
    noteShuffle: "â€» å•é¡Œã‚»ãƒƒãƒˆãŒå¤‰ã‚ã‚‹ä»•æ§˜ã«ã™ã‚‹å ´åˆã¯ã€ç”Ÿæˆå´ï¼ˆæŠ½å‡ºï¼‰ã§åˆ¶å¾¡ã—ã¦ãã ã•ã„ã€‚",
    miss: "ãƒŸã‚¹",
    score: "æ­£è§£",
    levelLabel: "ç†è§£åº¦",

    judge: {
     good: "åˆæ ¼ãƒ¬ãƒ™ãƒ«",
     warn: "è¦å¾©ç¿’",
     bad:  "åŸºç¤ä¸è¶³",
     goodMsg: "N5æ–‡æ³•ã¯å®‰å®šã—ã¦ã„ã¾ã™",
     warnMsg: "å¼±ç‚¹æ–‡æ³•ã‚’é‡ç‚¹çš„ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†",
     badMsg:  "æ–‡æ³•ã®åŸºç¤ã‹ã‚‰ã‚„ã‚Šç›´ã—ã¾ã—ã‚‡ã†"
   },
   groups: {
     PARTICLE: "åŠ©è©",
     COMMUNICATION: "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ–‡æ³•",
     ORDER: "ä¸¦ã³æ›¿ãˆ",
     BASIC_GRAMMAR: "åŸºæœ¬æ–‡æ³•"
   },
   groupHint: {
    PARTICLE: {
     ja: "ã€Œã‚’ãƒ»ã«ãƒ»ã§ã€ãªã©ã®ä½¿ã„åˆ†ã‘ãŒã€ã¾ã å®‰å®šã—ã¦ã„ã¾ã›ã‚“ã€‚æ–‡ã®ä¸­ã§ã€Œã ã‚ŒãŒãƒ»ãªã«ã‚’ãƒ»ã©ã“ã§ã€ã‚’è€ƒãˆã¾ã—ã‚‡ã†ã€‚",
     ko: "ã€Œã‚’ãƒ»ã«ãƒ»ã§ã€ì˜ êµ¬ë¶„ì´ ì•„ì§ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤. ë¬¸ì¥ì—ì„œ â€˜ëˆ„ê°€ãƒ»ë¬´ì—‡ì„ãƒ»ì–´ë””ì—ì„œâ€™ë¥¼ ìƒê°í•´ ë³´ì„¸ìš”.",
     en: "The use of particles like wo/ni/de is still unstable. Think about who, what, and where in the sentence.",
     de: "Die Verwendung von wo/ni/de ist noch unsicher. Denke an: wer, was, wo."
   },
   COMMUNICATION: {
     ja: "ç›¸æ‰‹ã«ä¾é ¼ãƒ»è¨±å¯ãƒ»ç¦æ­¢ã‚’ä¼ãˆã‚‹æ–‡ãŒã€å°‘ã—é›£ã—ã„ã‚ˆã†ã§ã™ã€‚çŸ­ã„æ–‡ã§ç·´ç¿’ã—ã¾ã—ã‚‡ã†ã€‚",
     ko: "í—ˆê°€Â·ê¸ˆì§€ í‘œí˜„ì´ ì–´ë µìŠµë‹ˆë‹¤. ì§§ì€ ë¬¸ì¥ìœ¼ë¡œ ì—°ìŠµí•´ ë³´ì„¸ìš”.",
     en: "Permission and prohibition expressions are difficult. Practice with short sentences.",
     de: "AusdrÃ¼cke fÃ¼r Erlaubnis und Verbot sind schwierig. Ãœbe mit kurzen SÃ¤tzen."
   },
   ORDER: {
     ja: "æ–‡ã®èªé †ï¼ˆã©ã®èªã‚’å…ˆã«ç½®ãã‹ï¼‰ãŒã€ã¾ã ä¸å®‰å®šã§ã™ã€‚ä¸»èªãƒ»ç›®çš„èªãƒ»å‹•è©ã®ä¸¦ã³ã‚’æ„è­˜ã—ã¾ã—ã‚‡ã†ã€‚",
     ko: "ì–´ìˆœì´ ì•„ì§ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤. ì£¼ì–´Â·ëª©ì ì–´Â·ë™ì‚¬ì˜ ìˆœì„œë¥¼ ì˜ì‹í•˜ì„¸ìš”.",
     en: "Word order is still unstable. Pay attention to subject, object, and verb.",
     de: "Die Wortstellung ist noch unsicher. Achte auf Subjekt, Objekt und Verb."
   },
   BASIC_GRAMMAR: {
     ja: "æ—¥æœ¬èªã®åŸºæœ¬çš„ãªæ–‡ã®å½¢ã‚’ã€ä¾‹æ–‡ã§ä¸€ã¤ãšã¤ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚",
     ko: "ì¼ë³¸ì–´ ê¸°ë³¸ ë¬¸í˜•ì„ ì˜ˆë¬¸ê³¼ í•¨ê»˜ í•˜ë‚˜ì”© í™•ì¸í•˜ì„¸ìš”.",
     en: "Check basic sentence patterns one by one with examples.",
     de: "ÃœberprÃ¼fe grundlegende Satzmuster einzeln mit Beispielen."
  }
},
   levelWord: {
     high: "ã‚ˆãã§ãã¦ã„ã¾ã™",
     mid: "ã ã„ãŸã„ç†è§£ã—ã¦ã„ã¾ã™",
     low: "ã¾ã ä¸å®‰å®šã§ã™",
     veryLow: "é‡ç‚¹çš„ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†"
   }
 },

  en: {
    result: "Results",
    passline: "Pass line: 65%",
    grammarLevel: "â–¼ Grammar understanding by category",
    legend: "Legend: Red=Weak / Orange=Almost / Green=Good",
    review: "â–¼ Grammar to review",
    retry: "Try again",
    rate: (r,c,t)=>`Accuracy ${r}% (${c} / ${t})`,
    levelIntro: "Not stable yet. Review the following points carefully.",
    
    test: "Test",
    noteShuffle: "â€» If you want the question set to change, control it on the generation side.",
    miss: "Mistakes",
    perfect: "Perfect!",
    score: "Correct",
    levelLabel: "Level",
    
    judge: {
     good: "Pass level",
     warn: "Needs review",
     bad:  "Insufficient basics",
     goodMsg: "Your N5 grammar is stable.",
     warnMsg: "Review weak grammar points.",
     badMsg:  "Restart from grammar basics."
   },
   groups: {
     PARTICLE: "Particles",
     COMMUNICATION: "Communication grammar",
     ORDER: "Word order",
     BASIC_GRAMMAR: "Basic grammar"
   },
   levelWord: {
     high: "Very good",            // en
     mid: "Mostly understood",
     low: "Not stable yet",
     veryLow: "Needs intensive review"
   }
 },

  de: {
    result: "Ergebnis",
    passline: "Bestehensgrenze: 65%",
    grammarLevel: "â–¼ GrammatikverstÃ¤ndnis nach Kategorien",
    legend: "Legende: Rot=Schwach / Orange=Fast / GrÃ¼n=Gut",
    review: "â–¼ Zu wiederholende Grammatik",
    retry: "Noch einmal",
    rate: (r,c,t)=>`Quote ${r}% (${c} / ${t})`,
    levelIntro: "Noch unsicher. Bitte Ã¼berprÃ¼fen Sie die folgenden Punkte.",

    test: "Test",
    noteShuffle: "â€» Wenn sich der Fragensatz Ã¤ndern soll, steuern Sie dies bitte auf der Generierungsseite.",
    miss: "Fehler",
    perfect: "Perfekt!",
    score: "Richtig",
    levelLabel: "Niveau",
    
    judge: {
     good: "Bestanden",
     warn: "Wiederholung nÃ¶tig",
     bad:  "Grundlagen unzureichend",
     goodMsg: "Ihre N5-Grammatik ist stabil.",
     warnMsg: "Bitte wiederholen Sie die schwÃ¤cheren Grammatikpunkte.",
     badMsg:  "Beginnen Sie erneut mit den grammatischen Grundlagen."
   },
   groups: {
     PARTICLE: "Partikeln",
     COMMUNICATION: "Kommunikationsgrammatik",
     ORDER: "Wortstellung",
     BASIC_GRAMMAR: "Grundgrammatik"
   },
   levelWord: {
     high: "Sehr gut",             // de
     mid: "GrÃ¶ÃŸtenteils verstanden",
     low: "Noch unsicher",
     veryLow: "Intensive Wiederholung nÃ¶tig"
   }
 },

  ko: {
    result: "ì§„ë‹¨ ê²°ê³¼",
    passline: "í•©ê²© ê¸°ì¤€: 65%",
    grammarLevel: "â–¼ ë¬¸ë²• ì´í•´ë„",
    legend: "ìƒ‰ìƒ: ë¹¨ê°•=ì•½í•¨ / ì£¼í™©=ê±°ì˜ / ì´ˆë¡=ì˜í•¨",
    review: "â–¼ ë³µìŠµí•  ë¬¸ë²•",
    retry: "ë‹¤ì‹œ í•˜ê¸°",
    rate: (r,c,t)=>`ì •ë‹µë¥  ${r}% (${c} / ${t})`,
    levelIntro: "ì•„ì§ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤. ì•„ë˜ í•­ëª©ì„ ì¤‘ì‹¬ìœ¼ë¡œ ë³µìŠµí•˜ì„¸ìš”.",

    test: "í…ŒìŠ¤íŠ¸",
    noteShuffle: "â€» ë¬¸ì œ ì„¸íŠ¸ê°€ ë³€ê²½ë˜ë„ë¡ í•˜ë ¤ë©´ ìƒì„± ë‹¨ê³„ì—ì„œ ì œì–´í•˜ì„¸ìš”.",
    miss: "ì‹¤ìˆ˜",
    perfect: "ì™„ë²½í•´ìš”!",
    score: "ì •ë‹µ",
    levelLabel: "ì´í•´ë„",
    
     judge: {
     good: "í•©ê²© ìˆ˜ì¤€",
     warn: "ë³µìŠµ í•„ìš”",
     bad:  "ê¸°ì´ˆ ë¶€ì¡±",
     goodMsg: "N5 ë¬¸ë²•ì´ ì•ˆì •ì ìœ¼ë¡œ ì´í•´ë˜ê³  ìˆìŠµë‹ˆë‹¤.",
     warnMsg: "ì•½í•œ ë¬¸ë²• í•­ëª©ì„ ì§‘ì¤‘ì ìœ¼ë¡œ ë³µìŠµí•˜ì„¸ìš”.",
     badMsg:  "ë¬¸ë²•ì˜ ê¸°ì´ˆë¶€í„° ë‹¤ì‹œ í•™ìŠµí•˜ì„¸ìš”."
    },
    groups: {
     PARTICLE: "ì¡°ì‚¬",
     COMMUNICATION: "ì˜ì‚¬ì†Œí†µ ë¬¸ë²•",
     ORDER: "ì–´ìˆœ",
     BASIC_GRAMMAR: "ê¸°ë³¸ë¬¸ë²•"
    },
    levelWord: {
     high: "ì˜ ì´í•´í•˜ê³  ìˆìŠµë‹ˆë‹¤",  // ko
     mid: "ëŒ€ì²´ë¡œ ì´í•´í•˜ê³  ìˆìŠµë‹ˆë‹¤",
     low: "ì•„ì§ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤",
     veryLow: "ì§‘ì¤‘ ë³µìŠµì´ í•„ìš”í•©ë‹ˆë‹¤"
   }
  }
};

const GROUP_ORDER = ["PARTICLE","COMMUNICATION","ORDER","BASIC_GRAMMAR"];
const GROUP_LABEL = {
  PARTICLE: "group_particle",
  COMMUNICATION: "group_communication",
  ORDER:"group_order",
  BASIC_GRAMMAR: "group_basic"
};
const GROUP_HINT = {
  PARTICLE: "group_hint_particle",
  COMMUNICATION: "group_hint_communication",
  ORDER: "group_hint_order",
  BASIC_GRAMMAR: "group_hint_basic"
};
const I18N = {
  ja: {
    group_hint_particle:
      "ã€Œã‚’ãƒ»ã«ãƒ»ã§ã€ãªã©ã®ä½¿ã„åˆ†ã‘ãŒã€ã¾ã å®‰å®šã—ã¦ã„ã¾ã›ã‚“ã€‚æ–‡ã®ä¸­ã§ã€Œã ã‚ŒãŒãƒ»ãªã«ã‚’ãƒ»ã©ã“ã§ã€ã‚’è€ƒãˆã¾ã—ã‚‡ã†ã€‚"
  },
  en: {
    group_hint_particle:
      "The usage of particles such as \"ã‚’\", \"ã«\", and \"ã§\" is not yet stable. Try thinking about \"who\", \"what\", and \"where\" in each sentence."
  },
  de: {
    group_hint_particle:
      "Die Verwendung von Partikeln wie â€ã‚’â€œ, â€ã«â€œ und â€ã§â€œ ist noch nicht stabil. Denke in jedem Satz an â€werâ€œ, â€wasâ€œ und â€woâ€œ."
  }
};
const LEVEL_WORD = (rate) => {
  if (rate >= 80) return "ã‚ˆãã§ãã¦ã„ã¾ã™";
  if (rate >= 50) return "ã ã„ãŸã„ç†è§£ã—ã¦ã„ã¾ã™";
  if (rate >= 30) return "ã¾ã ä¸å®‰å®šã§ã™ã€‚ä»¥ä¸‹ã®ãƒã‚¤ãƒ³ãƒˆã‚’æ„è­˜ã—ã¦å¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚";
  return "é‡ç‚¹çš„ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†";
};

let currentLang = "ja";

/* ===============================
 * å¿œç”¨ãƒ¬ãƒ“ãƒ¥ãƒ¼ å†æç”»ç”¨ï¼ˆâ˜…è¿½åŠ ï¼‰
 * =============================== */
 function redrawAppliedReview() {
  const T = APPLIED_REVIEW_TEXT[currentLang] ?? APPLIED_REVIEW_TEXT.ja;
  const n = appliedReviewData.correct;

  qEl.textContent = T.title;
  choicesEl.innerHTML = "";

  choicesEl.insertAdjacentHTML(
    "beforeend",
    `<div style="font-weight:600; margin-bottom:8px;">${T.score(n)}</div>`
  );

  const msg =
    n >= 3 ? T.c3 :
    n === 2 ? T.c2 : T.c1;

  const box = document.createElement("div");
  box.style.whiteSpace = "pre-line";
  box.style.fontSize = "16px";
  box.style.lineHeight = "1.8";
  box.textContent = msg;
  choicesEl.appendChild(box);

  nextBtn.textContent = T.next3;
  nextBtn.disabled = false;
}
function setLang(lang){
  currentLang = lang;
  window.currentLang = lang; // â† è¨ºæ–­åˆ†æç”¨
  console.log("setLang called:", lang);

  const title = document.getElementById("title");
  const titleText = document.getElementById("titleText");
  const intro = document.getElementById("intro");
  const what = document.getElementById("what");
  const featA = document.getElementById("featA");
  const featB = document.getElementById("featB");
  const featC = document.getElementById("featC");
  const recommend = document.getElementById("recommend");

  const about = document.getElementById("about");
  const rule1 = document.getElementById("rule1");
  const rule2 = document.getElementById("rule2");
  const rule3 = document.getElementById("rule3");
  const rule4 = document.getElementById("rule4");
  const rule5 = document.getElementById("rule5");
  const start = document.getElementById("start");
  const readyStatus = document.getElementById("readyStatus");
  const toPage3Btn = document.getElementById("toPage3");
  const mustSelectNote = document.getElementById("mustSelectNote");

  // =========================
  // æ—¥æœ¬èª
  // =========================
  if(lang === "ja"){
   if(titleText) titleText.textContent = "JLPT N5å¯¾ç­–ã‚¢ãƒ—ãƒª";
   if(intro) intro.innerHTML = "ã“ã‚“ã«ã¡ã¯ï¼<br>ã“ã®ã‚¢ãƒ—ãƒªã¯ã€JLPT N5ã®æ–‡æ³•ã‚’ ã¹ã‚“ãã‚‡ã†ã™ã‚‹ ã‚¢ãƒ—ãƒªã§ã™ã€‚";
   if(what) what.textContent = "ã“ã®ã‚¢ãƒ—ãƒªã§ã¯ã€ã¤ãã® 3ã¤ ãŒ ã§ãã¾ã™ã€‚";
   if(featA) featA.textContent = "ã„ã¾ã® æ—¥æœ¬èªãƒ¬ãƒ™ãƒ«ã‚’ ã—ã‚‰ã¹ã¾ã™ã€‚";
   if(featB) featB.textContent = "ã«ãŒã¦ãª æ–‡æ³•ãŒ ã‚ã‹ã‚Šã¾ã™ã€‚";
   if(featC) featC.textContent = "ã«ãŒã¦ãª æ–‡æ³•ã‚’ ãŸãã•ã‚“ ã‚Œã‚“ã—ã‚…ã†ã—ã¾ã™ã€‚";
   if(recommend) recommend.innerHTML = "ã¯ã˜ã‚ã¦ã®äººã¯ã€<strong>Aï¼ˆãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ï¼‰</strong>ã‹ã‚‰ ã¯ã˜ã‚ã¦ãã ã•ã„ã€‚";

   if(about) about.textContent = "ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ã«ã¤ã„ã¦";
   if(rule1) rule1.innerHTML = "ã‚‚ã‚“ã ã„ã¯ <strong>40å•</strong> ã‚ã‚Šã¾ã™ã€‚";
   if(rule2) rule2.textContent = "æ–‡ã‚’ ã‚ˆã‚“ã§ã€ï¼ˆã€€ï¼‰ã‚„ï¼ˆâ˜…ï¼‰ã« ã¯ã„ã‚‹ ã„ã¡ã°ã‚“ ã„ã„ ã“ã¨ã°ã‚’ ãˆã‚‰ã³ã¾ã™ã€‚";
   if(rule3) rule3.innerHTML = "ãˆã‚‰ã¶ ã“ã¨ã°ã¯ <strong>4ã¤</strong> ã‚ã‚Šã¾ã™ã€‚";
   if(rule4) rule4.textContent = 
      "ï¼ˆã€€ã€€ï¼‰ã«ï¼ˆâ˜…ï¼‰ãŒ ã‚ã‚‹ ã‚‚ã‚“ã ã„ãŒ ã‚ã‚Šã¾ã™ã€‚ã“ã¨ã°ã‚’ ãŸã ã—ã„ ã˜ã‚…ã‚“ã°ã‚“ã« ãªã‚‰ã¹ã¦ã€ï¼ˆâ˜…ï¼‰ã® ã“ã¨ã°ã‚’ ãˆã‚‰ã‚“ã§ãã ã•ã„ã€‚";

   if(rule5) rule5.textContent = "ãˆã‚‰ã°ãªã„ã¨ã€ã¤ãã« ã™ã™ã¿ã¾ã›ã‚“ã€‚";
   if(start) start.textContent = "ã˜ã‚…ã‚“ã³ãŒ ã§ããŸã‚‰ã€ã—ãŸã® ãƒœã‚¿ãƒ³ã‚’ ãŠã—ã¦ãã ã•ã„ã€‚";
   if(readyStatus) readyStatus.textContent = "æº–å‚™OK";
   if(toPage3Btn) toPage3Btn.textContent = "â–¶ ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ã‚’ã¯ã˜ã‚ã‚‹";

   if(mustSelectNote) mustSelectNote.textContent = "â€» é¸æŠã—ãªã„ã¨é€²ã‚ã¾ã›ã‚“ï¼ˆä»•æ§˜ã©ãŠã‚Šï¼‰";
}
  // =========================
  // English
  // =========================
  else if(lang === "en"){
   if(titleText) titleText.textContent = "JLPT N5 Prep App";
   if(intro) intro.innerHTML = "Hello!<br>This app helps you study JLPT N5 grammar.";
   if(what) what.textContent = "With this app, you can do the following three things:";
   if(featA) featA.textContent = "Check your current Japanese level.";
   if(featB) featB.textContent = "Find out which grammar points are difficult for you.";
   if(featC) featC.textContent = "Practice difficult grammar intensively.";
   if(recommend) recommend.innerHTML =
    "If this is your first time, please start with <strong>A (Level Check)</strong>.";

   if(about) about.textContent = "About the Level Check";
   if(rule1) rule1.innerHTML = "There are <strong>40 questions</strong>.";
   if(rule2) rule2.textContent =
    "Read each sentence and choose the best word for ( ) or (â˜…).";
   if(rule3) rule3.innerHTML = "There are <strong>4 choices</strong>.";
   if(rule4) rule4.textContent =
    "Some questions have (â˜…). Put the words in the correct order and choose the word for (â˜…).";
   if(rule5) rule5.textContent = "You must select an answer to proceed.";
   if(start) start.textContent = "When you are ready, press the button below.";
   if(readyStatus) readyStatus.textContent = "Ready";
   if(toPage3Btn) toPage3Btn.textContent = "â–¶ Start the Level Check";

   if(mustSelectNote){
     mustSelectNote.textContent =
      "â€» You must select an answer to proceed.";
  }
}

  // =========================
  // Deutsch
  // =========================
  else if(lang === "de"){
   if(titleText) titleText.textContent = "JLPT N5 Vorbereitung";
   if(intro) intro.innerHTML =
     "Hallo!<br>Diese App hilft dir beim Lernen der JLPT-N5-Grammatik.";
   if(what) what.textContent =
     "Mit dieser App kannst du die folgenden drei Dinge tun:";
   if(featA) featA.textContent =
     "ÃœberprÃ¼fe dein aktuelles Japanisch-Niveau.";
   if(featB) featB.textContent =
     "Finde heraus, welche Grammatikpunkte dir schwerfallen.";
   if(featC) featC.textContent =
     "Ãœbe schwierige Grammatik intensiv.";
   if(recommend) recommend.innerHTML =
     "Wenn dies dein erstes Mal ist, beginne bitte mit <strong>A (Leveltest)</strong>.";

   if(about) about.textContent = "Ãœber den Leveltest";
   if(rule1) rule1.innerHTML = "Es gibt <strong>40 Fragen</strong>.";
   if(rule2) rule2.textContent =
     "Lies den Satz und wÃ¤hle das beste Wort fÃ¼r ( ) oder (â˜…).";
   if(rule3) rule3.innerHTML =
     "Es gibt <strong>4 AntwortmÃ¶glichkeiten</strong>.";
   if(rule4) rule4.textContent =
     "Einige Fragen haben ein (â˜…). Ordne die WÃ¶rter in die richtige Reihenfolge und wÃ¤hle das Wort fÃ¼r (â˜…).";
   if(rule5) rule5.textContent =
     "Ohne Auswahl kannst du nicht fortfahren.";
   if(start) start.textContent =
     "Wenn du bereit bist, drÃ¼cke die Taste unten.";
   if(readyStatus) readyStatus.textContent = "Bereit";
   if(toPage3Btn) toPage3Btn.textContent = "â–¶ Leveltest starten";
  
   if(mustSelectNote){
     mustSelectNote.textContent =
      "â€» Bitte wÃ¤hle eine Antwort, um fortzufahren.";
  }
}
  // =========================
  // í•œêµ­ì–´
  // =========================
  else if(lang === "ko"){
   if(titleText) titleText.textContent = "JLPT N5 ëŒ€ë¹„ ì•±";
   if(intro) intro.innerHTML =
     "ì•ˆë…•í•˜ì„¸ìš”!<br>ì´ ì•±ì€ JLPT N5 ë¬¸ë²• í•™ìŠµì„ ë•ëŠ” ì•±ì…ë‹ˆë‹¤.";
   if(what) what.textContent =
     "ì´ ì•±ì—ì„œëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
   if(featA) featA.textContent =
     "í˜„ì¬ ì¼ë³¸ì–´ ì‹¤ë ¥ì„ í™•ì¸í•©ë‹ˆë‹¤.";
   if(featB) featB.textContent =
     "ì–´ë ¤ìš´ ë¬¸ë²• í•­ëª©ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
   if(featC) featC.textContent =
     "ì–´ë ¤ìš´ ë¬¸ë²•ì„ ì§‘ì¤‘ì ìœ¼ë¡œ ì—°ìŠµí•©ë‹ˆë‹¤.";
   if(recommend) recommend.innerHTML =
     "ì²˜ìŒì´ë¼ë©´ <strong>A(ë ˆë²¨ ì²´í¬)</strong>ë¶€í„° ì‹œì‘í•˜ì„¸ìš”.";

   if(about) about.textContent = "ë ˆë²¨ ì²´í¬ ì•ˆë‚´";
   if(rule1) rule1.innerHTML = "<strong>40ë¬¸ì œ</strong>ê°€ ìˆìŠµë‹ˆë‹¤.";
   if(rule2) rule2.textContent =
     "ë¬¸ì¥ì„ ì½ê³  ( ) ë˜ëŠ” (â˜…)ì— ë“¤ì–´ê°ˆ ê°€ì¥ ì•Œë§ì€ ë§ì„ ê³ ë¥´ì„¸ìš”.";
   if(rule3) rule3.innerHTML = "<strong>4ê°œì˜ ì„ íƒì§€</strong>ê°€ ìˆìŠµë‹ˆë‹¤.";
   if(rule4) rule4.textContent =
    "(â˜…)ê°€ ìˆëŠ” ë¬¸ì œë„ ìˆìŠµë‹ˆë‹¤. ë‹¨ì–´ë¥¼ ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ë°°ì—´í•œ ë’¤ (â˜…)ì˜ ë‹¨ì–´ë¥¼ ê³ ë¥´ì„¸ìš”.";
   if(rule5) rule5.textContent =
     "ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
   if(start) start.textContent =
     "ì¤€ë¹„ê°€ ë˜ë©´ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”.";
   if(readyStatus) readyStatus.textContent = "ì¤€ë¹„ ì™„ë£Œ";
   if(toPage3Btn) toPage3Btn.textContent = "â–¶ ë ˆë²¨ ì²´í¬ ì‹œì‘";

   if(mustSelectNote){
     mustSelectNote.textContent =
      "â€» ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
  }
}
  // â˜… A / B / C ã¯åˆå›ã®ã¿è¨­å®šï¼ˆå†æç”»ã§æºã‚Œã•ã›ãªã„ï¼‰
  if (!window._abcLabelFixed) {
  setTimeout(() => {
    document.getElementById("btnA").textContent =
      lang==="en" ? "[ A Level Check ]"
      : lang==="de" ? "[ A Leveltest ]"
      : lang==="ko" ? "[ A ë ˆë²¨ ì²´í¬ ]"
      : "[ A ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯ ]";

    document.getElementById("btnB").textContent =
      lang==="en" ? "[ B Weakness Analysis ]"
      : lang==="de" ? "[ B SchwÃ¤chenanalyse ]"
      : lang==="ko" ? "[ B ì•½ì  ë¶„ì„ ]"
      : "[ B å¼±ç‚¹åˆ†æ ]";

    document.getElementById("btnC").textContent =
      lang==="en" ? "[ C Practice ]"
      : lang==="de" ? "[ C Training ]"
      : lang==="ko" ? "[ C ì—°ìŠµ ]"
      : "[ C å¼·åŒ–ç·´ç¿’ ]";
  }, 0);
    window._abcLabelFixed = true;
  }

  // â˜… å¼·åŒ–ç·´ç¿’ãƒœã‚¿ãƒ³ï¼ˆã“ã‚Œã¯æ¯å›ã§OKï¼‰
  const startPracticeBtn = document.getElementById("startPractice");
  if (startPracticeBtn) {
    startPracticeBtn.textContent =
      lang === "en" ? "â–¶ Start Practice"
      : lang === "de" ? "â–¶ Training starten"
      : lang === "ko" ? "â–¶ ì—°ìŠµ ì‹œì‘"
      : "â–¶ å¼·åŒ–ç·´ç¿’ã‚’ã¯ã˜ã‚ã‚‹";
  }

// â˜…â˜…â˜… ã“ã“ â˜…â˜…â˜…

  const appliedTitle = document.getElementById("appliedTitle");
  const appliedDesc  = document.getElementById("appliedDesc");

  if (appliedTitle && appliedDesc) {
   if (lang === "en") {
     appliedTitle.textContent = "About Applied Practice";
     appliedDesc.innerHTML =
      "Read a short passage.<br>" +
      "Choose the best word for the blank ( ).<br>" +
      "Select the correct answer from three options.<br><br>" +
      "If you can complete this practice,<br>" +
      "you understand N5-level grammar well.<br>" +
      "Please proceed with confidence.";
  }  else if (lang === "de") {
     appliedTitle.textContent = "Ãœber die AnwendungsÃ¼bung";
     appliedDesc.innerHTML =
      "Lies einen kurzen Text.<br>" +
      "WÃ¤hle das beste Wort fÃ¼r die LÃ¼cke ( ).<br>" +
      "WÃ¤hle eine Antwort aus drei Optionen.<br><br>" +
      "Wenn du diese Ãœbung schaffst,<br>" +
      "verstehst du die N5-Grammatik gut.<br>" +
      "Bitte mache selbstbewusst weiter.";
  }  else if (lang === "ko") {
     appliedTitle.textContent = "ì‘ìš© ì—°ìŠµ ì•ˆë‚´";
     appliedDesc.innerHTML =
      "ì§§ì€ ë¬¸ì¥ì„ ì½ê³ ,<br>" +
      "( )ì— ë“¤ì–´ê°ˆ ê°€ì¥ ì•Œë§ì€ ë§ì„ ê³ ë¦…ë‹ˆë‹¤.<br>" +
      "3ê°œì˜ ì„ íƒì§€ ì¤‘ì—ì„œ ì„ íƒí•˜ì„¸ìš”.<br><br>" +
      "ì´ ì—°ìŠµì„ í•  ìˆ˜ ìˆë‹¤ë©´,<br>" +
      "N5 ìˆ˜ì¤€ì˜ ë¬¸ë²•ì„ ì´í•´í•˜ê³  ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.<br>" +
      "ì•ˆì‹¬í•˜ê³  ë‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ì„¸ìš”.";
  }  else {
     appliedTitle.textContent = "å¿œç”¨ç·´ç¿’ã«ã¤ã„ã¦";
     appliedDesc.innerHTML =
      "çŸ­ã„æ–‡ã—ã‚‡ã†ã‚’ ã‚ˆã¿ã€<br>" +
      "ï¼ˆã€€ã€€ï¼‰ã« å…¥ã‚‹ ã„ã¡ã°ã‚“ ã„ã„ ã“ã¨ã°ã‚’ã€<br>" +
      "ï¼“ã¤ã®ä¸­ã‹ã‚‰ ãˆã‚‰ã³ã¾ã™ã€‚<br><br>" +
      "ã“ã® å¿œç”¨ç·´ç¿’ãŒ ã§ãã‚Œã°ã€<br>" +
      "ã‚ãªãŸã¯ N5ãƒ¬ãƒ™ãƒ«ã® æ–‡æ³•ã‚’ ã‚Šã‹ã„ã—ã¦ã„ã¾ã™ã€‚<br>" +
      "å®‰å¿ƒã—ã¦ã€ã¤ãã« ã™ã™ã‚“ã§ ãã ã•ã„ã€‚";
  }
}
  // â–¼ å¿œç”¨ç·´ç¿’ã‚’ã¯ã˜ã‚ã‚‹ ãƒœã‚¿ãƒ³ï¼ˆã“ã“ãŒæ­£è§£ï¼‰
 const startAppliedBtn = document.getElementById("startAppliedPractice");
 if (startAppliedBtn) {
   startAppliedBtn.textContent =
     lang === "en" ? "â–¶ Start Applied Practice"
     : lang === "de" ? "â–¶ AnwendungsÃ¼bung starten"
     : lang === "ko" ? "â–¶ ì‘ìš© ì—°ìŠµ ì‹œì‘"
     : "â–¶ å¿œç”¨ç·´ç¿’ã‚’ã¯ã˜ã‚ã‚‹";
}


  // â˜… ã“ã“ã«å…¥ã‚Œã‚‹ï¼ˆsetLang ã®æœ€å¾Œï¼‰
    if (typeof showDiagnosis === "function" && window.lastDiagnosisResult) {
      showDiagnosis();
  }
    if (
     window.practiceMode === true &&
     resultView.style.display === "block" &&
     typeof showPracticeResult === "function"
  ) {
    showPracticeResult();
  }
  if (currentExplanationQuestion && currentExplanationBox) {
      const q = currentExplanationQuestion;
      currentExplanationBox.textContent =
        q.explanation?.[currentLang]
        ?? q.explanation?.ja
        ?? "ï¼ˆè§£èª¬ã¯æœªç™»éŒ²ï¼‰";
    }
  // â˜… æŒ¯ã‚Šè¿”ã‚Šç”»é¢ãŒå‡ºã¦ã„ã‚‹å ´åˆã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ã ã‘å†æç”»
  

  if (
  window.practiceMode === "APPLIED" &&
  isAppliedReviewScreen === true &&
  appliedReviewData
) {
  redrawAppliedReview();
}
}
window.setLang = setLang;

// ã€Œé–“é•ãˆãŸæ–‡æ³•ã ã‘ã€å€‹åˆ¥èª¬æ˜ï¼ˆã‚ãªãŸãŒä½œã£ãŸæ–‡ç« ã‚’çŸ­ããã®ã¾ã¾ï¼‰
const GRAMMAR_EXPLAIN = {
  "ãŒ": {
    ja: "ã€åŠ©è©ã€ŒãŒã€ã€‘æ„å‘³ï¼šæ–‡ã®ä¸­ã§ã€Œã ã‚ŒãŒãƒ»ãªã«ãŒã€ã‚’ç¤ºã™ã€‚æ–°ã—ã„æƒ…å ±ã‚„ã€å¼·èª¿ã—ãŸã„ä¸»èªã‚’è¡¨ã™ã€‚ä¾‹ï¼šã­ã“ãŒã„ã¾ã™ã€‚ã ã‚ŒãŒæ¥ã¾ã—ãŸã‹ã€‚",
    en: "Particle \"ga\": marks the subject, especially new or emphasized information. Example: A cat is here. Who came?",
    de: "Partikel â€gaâ€œ: kennzeichnet das Subjekt, besonders neue oder betonte Information. Beispiel: Eine Katze ist da. Wer ist gekommen?",
    ko: "ì¡°ì‚¬ ã€ŒãŒã€: ë¬¸ì¥ì—ì„œ ì£¼ì–´ë¥¼ ë‚˜íƒ€ë‚´ë©°, ìƒˆ ì •ë³´ë‚˜ ê°•ì¡°í•  ëŒ€ìƒì„ í‘œì‹œí•¨. ì˜ˆ: ê³ ì–‘ì´ê°€ ìˆì–´ìš”. ëˆ„ê°€ ì™”ì–´ìš”?"
  },
  "ã‚’": {
    ja: "ã€åŠ©è©ã€Œã‚’ã€ã€‘æ„å‘³ï¼šå‹•ä½œã®å¯¾è±¡ã‚’è¡¨ã™ã€‚ã ã‚ŒãŒã€Œãªã«ã‚’ã€ã™ã‚‹ã‹ã‚’ç¤ºã™ã€‚ä¾‹ï¼šã”ã¯ã‚“ã‚’é£Ÿã¹ã¾ã™ã€‚æœ¬ã‚’èª­ã¿ã¾ã™ã€‚",
    en: "Particle \"wo\": marks the direct object of an action. Example: I eat rice. I read a book.",
    de: "Partikel â€woâ€œ: kennzeichnet das direkte Objekt einer Handlung. Beispiel: Ich esse Reis. Ich lese ein Buch.",
    ko: "ì¡°ì‚¬ ã€Œã‚’ã€: ë™ì‘ì˜ ëŒ€ìƒì„ ë‚˜íƒ€ëƒ„. ì˜ˆ: ë°¥ì„ ë¨¹ì–´ìš”. ì±…ì„ ì½ì–´ìš”."
  },
  "ã«": {
    ja: "ã€åŠ©è©ã€Œã«ã€ã€‘æ„å‘³ï¼šæ–‡ã®ä¸­ã§ã€Œæ™‚é–“ã€ã€Œç›®çš„åœ°ã€ã€Œå­˜åœ¨ã™ã‚‹å ´æ‰€ã€ãªã©ã‚’è¡¨ã™åŠ©è©ã§ã™ã€‚\n\nâ‘  æ™‚é–“ï¼šå‹•ä½œãŒèµ·ã“ã‚‹æ™‚åˆ»ã‚„æ—¥ä»˜ã‚’ç¤ºã—ã¾ã™ã€‚\nä¾‹ï¼š7æ™‚ã«èµ·ãã¾ã™ã€‚æœˆæ›œæ—¥ã«å­¦æ ¡ã¸è¡Œãã¾ã™ã€‚\n\nâ‘¡ ç›®çš„åœ°ï¼šç§»å‹•ã®åˆ°ç€ç‚¹ãƒ»è¡Œãå…ˆã‚’ç¤ºã—ã¾ã™ã€‚\nä¾‹ï¼šå­¦æ ¡ã«è¡Œãã¾ã™ã€‚æ—¥æœ¬ã«æ¥ã¾ã—ãŸã€‚\n\næ–‡è„ˆã«ã‚ˆã£ã¦æ„å‘³ãŒå¤‰ã‚ã‚‹ãŸã‚ã€ã€Œä½•ã‚’è¡¨ã—ã¦ã„ã‚‹ã«ã‹ã€ã‚’æ„è­˜ã—ã¦ä½¿ã„åˆ†ã‘ã¾ã—ã‚‡ã†ã€‚",
    en: "Particle \"ni\": indicates time, destination, or the location where something exists.\n\nâ‘  Time: shows when an action happens.\nExample: I wake up at 7. I go to school on Monday.\n\nâ‘¡ Destination: shows the destination of movement.\nExample: I go to school. I came to Japan.\n\nPay attention to the context to understand which meaning \"ni\" has.",
    de: "Partikel â€niâ€œ: zeigt Zeitpunkte, Zielorte oder Existenzorte an.\n\nâ‘  Zeit: Zeitpunkt oder Datum einer Handlung.\nBeispiel: Ich stehe um 7 Uhr auf. Am Montag gehe ich zur Schule.\n\nâ‘¡ Ziel: Ziel einer Bewegung.\nBeispiel: Ich gehe zur Schule. Ich bin nach Japan gekommen.\n\nAchten Sie auf den Kontext, um die Bedeutung von â€niâ€œ richtig zu verstehen.",
    ko: "ì¡°ì‚¬ ã€Œã«ã€: ì‹œê°„, ëª©ì ì§€, ë˜ëŠ” ì¡´ì¬í•˜ëŠ” ì¥ì†Œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¡°ì‚¬ì…ë‹ˆë‹¤.\n\nâ‘  ì‹œê°„: ë™ì‘ì´ ì¼ì–´ë‚˜ëŠ” ì‹œê°ì´ë‚˜ ë‚ ì§œ.\nì˜ˆ: 7ì‹œì— ì¼ì–´ë‚˜ìš”. ì›”ìš”ì¼ì— í•™êµì— ê°€ìš”.\n\nâ‘¡ ëª©ì ì§€: ì´ë™ì˜ ë„ì°©ì ì´ë‚˜ í–‰ì„ ì§€.\nì˜ˆ: í•™êµì— ê°€ìš”. ì¼ë³¸ì— ì™”ì–´ìš”.\n\në¬¸ë§¥ì— ë”°ë¼ ì˜ë¯¸ê°€ ë‹¬ë¼ì§€ë¯€ë¡œ, ì–´ë–¤ ì˜ë¯¸ì˜ ã€Œã«ã€ì¸ì§€ ìƒê°í•˜ë©° ì‚¬ìš©í•˜ì„¸ìš”."
  },
  "ã§": {
    ja: "ã€åŠ©è©ã€Œã§ã€ã€‘æ„å‘³ï¼šå‹•ä½œãŒè¡Œã‚ã‚Œã‚‹å ´æ‰€ãƒ»æ‰‹æ®µãƒ»æ–¹æ³•ã‚’è¡¨ã™ã€‚ä¾‹ï¼šå­¦æ ¡ã§å‹‰å¼·ã—ã¾ã™ã€‚ãƒã‚¹ã§è¡Œãã¾ã™ã€‚",
    en: "Particle \"de\": indicates the place where an action occurs, or the means/method. Example: I study at school. I go by bus.",
    de: "Partikel â€deâ€œ: gibt den Ort einer Handlung oder das Mittel/Instrument an. Beispiel: Ich lerne in der Schule. Ich fahre mit dem Bus.",
    ko: "ì¡°ì‚¬ ã€Œã§ã€: ë™ì‘ì´ ì´ë£¨ì–´ì§€ëŠ” ì¥ì†Œë‚˜ ìˆ˜ë‹¨Â·ë°©ë²•ì„ ë‚˜íƒ€ëƒ„. ì˜ˆ: í•™êµì—ì„œ ê³µë¶€í•´ìš”. ë²„ìŠ¤ë¡œ ê°€ìš”."
  },
  "ã‹ã‚‰ã€œã¾ã§": {
    ja: "ã€åŠ©è©ã€Œã‹ã‚‰ã€œã¾ã§ã€ã€‘æ„å‘³ï¼šç¯„å›²ã®å§‹ã¾ã‚Šã¨çµ‚ã‚ã‚Šã‚’è¡¨ã™ï¼ˆæ™‚é–“ãƒ»å ´æ‰€ï¼‰ã€‚ä¾‹ï¼š9æ™‚ã‹ã‚‰5æ™‚ã¾ã§åƒãã¾ã™ã€‚æ±äº¬ã‹ã‚‰å¤§é˜ªã¾ã§è¡Œãã¾ã™ã€‚",
    en: "Particles \"kara ~ made\": indicate the start and end of a range (time/place). Example: I work from 9 to 5. I go from Tokyo to Osaka.",
    de: "Partikeln â€kara ~ madeâ€œ: geben Anfang und Ende eines Bereichs (Zeit/Ort) an. Beispiel: Ich arbeite von 9 bis 5. Ich fahre von Tokio nach Osaka.",
    ko: "ì¡°ì‚¬ ã€Œã‹ã‚‰~ã¾ã§ã€: ë²”ìœ„ì˜ ì‹œì‘ê³¼ ë(ì‹œê°„Â·ì¥ì†Œ)ì„ ë‚˜íƒ€ëƒ„. ì˜ˆ: 9ì‹œë¶€í„° 5ì‹œê¹Œì§€ ì¼í•´ìš”. ë„ì¿„ì—ì„œ ì˜¤ì‚¬ì¹´ê¹Œì§€ ê°€ìš”."
  },
  "ã‹ã‚‰": {
    ja: "ã€ã€Œã‹ã‚‰ã€ã€‘æ„å‘³ï¼šæ™‚é–“ãƒ»å ´æ‰€ãªã©ã®å§‹ã¾ã‚Šã‚’è¡¨ã™ã€‚ä¾‹ï¼š9æ™‚ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚",
    en: "Particle kara: indicates the starting point (time/place).",
    de: "Partikel kara: zeigt den Anfang (Zeit/Ort) an.",
    ko: "ì¡°ì‚¬ ã‹ã‚‰: ì‹œê°„Â·ì¥ì†Œì˜ ì‹œì‘ì„ ë‚˜íƒ€ëƒ„."
  }, 
  "ã¾ã§": {
    ja: "ã€ã€Œã¾ã§ã€ã€‘æ„å‘³ï¼šæ™‚é–“ãƒ»å ´æ‰€ãªã©ã®çµ‚ã‚ã‚Šã‚’è¡¨ã™ã€‚ä¾‹ï¼š5æ™‚ã¾ã§åƒãã¾ã™ã€‚",
    en: "Particle made: indicates the end point (time/place).",
    de: "Partikel made: zeigt das Ende (Zeit/Ort) an.",
    ko: "ì¡°ì‚¬ ã¾ã§: ì‹œê°„Â·ì¥ì†Œì˜ ëì„ ë‚˜íƒ€ëƒ„."
  },    
  "ã®": {
    ja: "ã€åŠ©è©ã€Œã®ã€ã€‘æ„å‘³ï¼šåè©ã¨åè©ã‚’ã¤ãªãã€æ‰€æœ‰ãƒ»æ‰€å±ãƒ»é–¢ä¿‚ãƒ»èª¬æ˜ã‚’è¡¨ã™ã€‚ä¾‹ï¼šã‚ãŸã—ã®æœ¬ã€‚æ—¥æœ¬ã®æ–‡åŒ–ã€‚",
    en: "Particle \"no\": connects nouns to show possession, affiliation, or description. Example: my book. Japanese culture.",
    de: "Partikel â€noâ€œ: verbindet Nomen und zeigt Besitz, ZugehÃ¶rigkeit oder nÃ¤here Bestimmung. Beispiel: mein Buch. die japanische Kultur.",
    ko: "ì¡°ì‚¬ ã€Œã®ã€: ëª…ì‚¬ì™€ ëª…ì‚¬ë¥¼ ì´ì–´ ì†Œìœ Â·ì†Œì†Â·ê´€ê³„ë¥¼ ë‚˜íƒ€ëƒ„. ì˜ˆ: ë‚˜ì˜ ì±…. ì¼ë³¸ì˜ ë¬¸í™”."
  },
  "ã¨": {
    ja: "ã€åŠ©è©ã€Œã¨ã€ã€‘æ„å‘³ï¼šã„ã£ã—ã‚‡ã«ã™ã‚‹ç›¸æ‰‹ã‚’è¡¨ã™ï¼ç‰©ã‚„äººã‚’ä¸¦ã¹ã¦ç¤ºã™ï¼è¨€ã£ãŸå†…å®¹ã‚’å¼•ç”¨ã™ã‚‹ã€‚ä¾‹ï¼šå‹ã ã¡ã¨è¡Œãã¾ã™ã€‚ã‚Šã‚“ã”ã¨ã¿ã‹ã‚“ã€‚ã€Œè¡Œãã¾ã™ã€ã¨è¨€ã„ã¾ã—ãŸã€‚",
    en: "Particle \"to\": indicates doing something together, lists items, or quotes speech. Example: I go with a friend. Apples and oranges. He said, â€œI will go.â€",
    de: "Partikel â€toâ€œ: zeigt Begleitung, AufzÃ¤hlung oder Zitat an. Beispiel: Ich gehe mit einem Freund. Ã„pfel und Orangen. Er sagte: â€Ich gehe.â€œ",
    ko: "ì¡°ì‚¬ ã€Œã¨ã€: í•¨ê»˜í•˜ëŠ” ëŒ€ìƒ, ë‚˜ì—´, ë§í•œ ë‚´ìš©ì„ ì¸ìš©í•  ë•Œ ì‚¬ìš©. ì˜ˆ: ì¹œêµ¬ì™€ ê°€ìš”. ì‚¬ê³¼ì™€ ê·¤. â€œê°„ë‹¤â€ê³  ë§í–ˆì–´ìš”."
  },
  "ã‚‚": {
    ja: "ã€åŠ©è©ã€Œã‚‚ã€ã€‘æ„å‘³ï¼šå‰ã®å†…å®¹ã«åŠ ãˆã¦ã€ŒåŒã˜ã ã€ã€Œè¿½åŠ ã ã€ã¨ã„ã†æ°—æŒã¡ã‚’è¡¨ã™ã€‚ä¾‹ï¼šã‚ãŸã—ã‚‚è¡Œãã¾ã™ã€‚æ°´ã‚‚ã‚ã‚Šã¾ã™ã€‚",
    en: "Particle \"mo\": means \"also\" or \"too\", adding something as the same or additional. Example: I will go too. There is water as well.",
    de: "Partikel â€moâ€œ: bedeutet â€auchâ€œ und fÃ¼gt etwas Gleiches oder ZusÃ¤tzliches hinzu. Beispiel: Ich gehe auch. Es gibt auch Wasser.",
    ko: "ì¡°ì‚¬ ã€Œã‚‚ã€: ì•ì˜ ë‚´ìš©ì— ë”í•´ â€˜ë„/ì—­ì‹œâ€™ë¥¼ ë‚˜íƒ€ëƒ„. ì˜ˆ: ë‚˜ë„ ê°€ìš”. ë¬¼ë„ ìˆì–´ìš”."
  },
  "ã‚„": {
    ja: "ã€åŠ©è©ã€Œã‚„ã€ã€‘æ„å‘³ï¼šã„ãã¤ã‹ã®ç‰©ã‚„äººã‚’ä¾‹ã¨ã—ã¦æŒ™ã’ã‚‹ï¼ˆå…¨éƒ¨ã§ã¯ãªã„ï¼‰ã€‚ä¾‹ï¼šã‚Šã‚“ã”ã‚„ãƒãƒŠãƒŠã‚’è²·ã„ã¾ã—ãŸã€‚",
    en: "Particle \"ya\": lists examples of items or people (not an exhaustive list). Example: I bought apples and bananas.",
    de: "Partikel â€yaâ€œ: nennt Beispiele mehrerer Dinge oder Personen (nicht vollstÃ¤ndig). Beispiel: Ich habe Ã„pfel und Bananen gekauft.",
    ko: "ì¡°ì‚¬ ã€Œã‚„ã€: ì—¬ëŸ¬ í•­ëª©ì„ ì˜ˆë¡œ ë“¤ì–´ ë‚˜ì—´í•¨(ì „ë¶€ëŠ” ì•„ë‹˜). ì˜ˆ: ì‚¬ê³¼ë‚˜ ë°”ë‚˜ë‚˜ë¥¼ ìƒ€ì–´ìš”."
  },
  "ã¾ã—ã‚‡ã†ã‹": {
    ja: "ã€ã¾ã—ã‚‡ã†ã‹ã€‘å½¢ï¼šVï¼ˆã¾ã™å½¢ï¼‰ï¼‹ã¾ã—ã‚‡ã†ã‹ã€‚æ„å‘³ï¼šç›¸æ‰‹ã«ç”³ã—å‡ºã‚‹è¨€ã„æ–¹ã€‚ä¾‹ï¼šæ‰‹ä¼ã„ã¾ã—ã‚‡ã†ã‹ã€‚",
    en: "Form: Verb (masu-stem) + mashou ka. Meaning: A polite way to offer help.",
    de: "Form: Verb (Masu-Stamm) + mashou ka. Bedeutung: HÃ¶fliches Angebot.",
    ko: "í˜•íƒœ: ë™ì‚¬(ã¾ã™í˜• ì–´ê°„)ï¼‹ã¾ã—ã‚‡ã†ã‹. ì˜ë¯¸: ì œì•ˆí•  ë•Œ ì“°ëŠ” í‘œí˜„."
  },
  "ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“": {
    ja: "ã€ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‘å½¢ï¼šVï¼ˆãªã„å½¢ï¼‰ï¼‹ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚æ„å‘³ï¼šã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ä¾‹ï¼šå®¿é¡Œã‚’ã—ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚",
    en: "Form: Verb (nai-form) + nakereba ikemasen. Meaning: must do.",
    de: "Form: Verb (nai-Form) + nakereba ikemasen. Bedeutung: mÃ¼ssen.",
    ko: "í˜•íƒœ: ë™ì‚¬(ãªã„í˜•)ï¼‹ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“. ì˜ë¯¸: ë°˜ë“œì‹œ í•´ì•¼ í•¨."
  },
  "ã¦ã¯ã„ã‘ã¾ã›ã‚“": {
    ja: "ã€ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‘å½¢ï¼šVï¼ˆã¦å½¢ï¼‰ï¼‹ã¯ã„ã‘ã¾ã›ã‚“ã€‚æ„å‘³ï¼šã—ã¦ã¯ã„ã‘ãªã„ã€‚ä¾‹ï¼šã“ã“ã§é£Ÿã¹ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚",
    en: "Form: Verb (te-form) + wa ikemasen. Meaning: must not do.",
    de: "Form: Verb (te-Form) + wa ikemasen. Bedeutung: nicht erlaubt.",
    ko: "í˜•íƒœ: ë™ì‚¬(ã¦í˜•)ï¼‹ã¯ã„ã‘ã¾ã›ã‚“. ì˜ë¯¸: í•˜ë©´ ì•ˆ ë¨."
  },
  "ã¦ã‚‚ã„ã„ã§ã™ã‹": {
    ja: "ã€ã€œã¦ã‚‚ã„ã„ã§ã™ã‹ã€‘å½¢ï¼šVï¼ˆã¦å½¢ï¼‰ï¼‹ã‚‚ã„ã„ã§ã™ã‹ã€‚æ„å‘³ï¼šç›¸æ‰‹ã«è¨±å¯ã‚’æ±‚ã‚ã‚‹è¨€ã„æ–¹ã€‚ä¾‹ï¼šã“ã“ã«åº§ã£ã¦ã‚‚ã„ã„ã§ã™ã‹ã€‚",
    en: "Form: Verb (te-form) + mo ii desu ka. Meaning: asking for permission. Example: May I sit here?",
    de: "Form: Verb (te-Form) + mo ii desu ka. Bedeutung: um Erlaubnis bitten. Beispiel: Darf ich mich hier setzen?",
    ko: "í˜•íƒœ: ë™ì‚¬(ã¦í˜•)ï¼‹ã‚‚ã„ã„ã§ã™ã‹. ì˜ë¯¸: í—ˆë½ì„ êµ¬í•˜ëŠ” í‘œí˜„. ì˜ˆ: ì—¬ê¸°ì— ì•‰ì•„ë„ ë ê¹Œìš”?"
  },
  "ãªãã¦ã‚‚ã„ã„ã§ã™ã‹": {
    ja: "ã€ãªãã¦ã‚‚ã„ã„ã§ã™ã‹ã€‘å½¢ï¼šVï¼ˆãªã„å½¢ï¼‰ï¼‹ãªãã¦ã‚‚ã„ã„ã§ã™ã‹ã€‚æ„å‘³ï¼šã—ãªãã¦ã‚‚ã‚ˆã„ã‹èãã€‚ä¾‹ï¼šæ˜æ—¥ã¯è¡Œã‹ãªãã¦ã‚‚ã„ã„ã§ã™ã‹ã€‚",
    en: "Form: Verb (nai-form) + nakutemo ii desu ka. Meaning: asking if something is not necessary.",
    de: "Form: Verb (nai-Form) + nakutemo ii desu ka. Bedeutung: fragen, ob etwas nicht nÃ¶tig ist.",
    ko: "í˜•íƒœ: ë™ì‚¬(ãªã„í˜•)ï¼‹ãªãã¦ã‚‚ã„ã„ã§ã™ã‹. ì˜ë¯¸: ì•ˆ í•´ë„ ë˜ëŠ”ì§€ ë¬»ëŠ” í‘œí˜„."
  },
  "å‰ã«": {
   ja: "ã€ã€œå‰ã«ã€‘å½¢ï¼šVï¼ˆè¾æ›¸å½¢ï¼‰ï¼‹å‰ã«ã€‚æ„å‘³ï¼šã‚ã‚‹å‹•ä½œã®å‰ã€‚ä¾‹ï¼šã­ã‚‹å‰ã«ã€ã¯ã‚’ã¿ãŒãã¾ã™ã€‚",
   en: "Form: Verb (dictionary form) + mae ni. Meaning: before doing something.",
   de: "Form: Verb (WÃ¶rterbuchform) + mae ni. Bedeutung: bevor man etwas tut.",
   ko: "í˜•íƒœ: ë™ì‚¬(ì‚¬ì „í˜•)ï¼‹å‰ã«. ì˜ë¯¸: ì–´ë–¤ í–‰ë™ì„ í•˜ê¸° ì „ì—."
  },
  "ã‚ã¨ã§": {
   ja: "ã€ã€œã‚ã¨ã§ã€‘å½¢ï¼šVï¼ˆãŸå½¢ï¼‰ï¼‹å¾Œã§ã€‚æ„å‘³ï¼šã‚ã‚‹å‹•ä½œã®å¾Œã€‚ä¾‹ï¼šé£Ÿã¹ãŸå¾Œã§ã€å‹‰å¼·ã—ã¾ã™ã€‚",
   en: "Form: Verb (ta-form) + ato de. Meaning: after doing something.",
   de: "Form: Verb (ta-Form) + ato de. Bedeutung: nachdem man etwas getan hat.",
   ko: "í˜•íƒœ: ë™ì‚¬(ãŸí˜•)ï¼‹ã‚ã¨ã§. ì˜ë¯¸: ì–´ë–¤ í–‰ë™ì„ í•œ ë’¤ì—."
  },
  "ãŸã„": {
   ja: "ã€ã€œãŸã„ã€‘å½¢ï¼šVï¼ˆã¾ã™å½¢ã®ã¾ã™ã‚’å–ã‚‹ï¼‰ï¼‹ãŸã„ã€‚æ„å‘³ï¼šè‡ªåˆ†ã®ã—ãŸã„æ°—æŒã¡ã€‚ä¾‹ï¼šæ—¥æœ¬ã«è¡ŒããŸã„ã§ã™ã€‚",
   en: "Form: Verb (masu-stem) + tai. Meaning: expressing what the speaker wants to do.",
   de: "Form: Verb (Masu-Stamm) + tai. Bedeutung: Wunsch des Sprechers.",
   ko: "í˜•íƒœ: ë™ì‚¬(ã¾ã™í˜• ì–´ê°„)ï¼‹ãŸã„. ì˜ë¯¸: ë§í•˜ëŠ” ì‚¬ëŒì˜ í¬ë§."
  },
  "ã¦ã‹ã‚‰": {
   ja: "ã€ã€œã¦ã‹ã‚‰ã€‘å½¢ï¼šVï¼ˆã¦å½¢ï¼‰ï¼‹ã‹ã‚‰ã€‚æ„å‘³ï¼šã‚ã‚‹å‹•ä½œãŒçµ‚ã‚ã£ãŸã‚ã¨ã§ã€æ¬¡ã®å‹•ä½œã‚’ã™ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ä¾‹ï¼šã”ã¯ã‚“ã‚’é£Ÿã¹ã¦ã‹ã‚‰ã€å‹‰å¼·ã—ã¾ã™ã€‚",
   en: "Form: Verb (te-form) + kara. Meaning: doing something after another action is completed. Example: I study after I eat.",
   de: "Form: Verb (te-Form) + kara. Bedeutung: etwas tun, nachdem eine andere Handlung abgeschlossen ist. Beispiel: Ich lerne, nachdem ich gegessen habe.",
   ko: "í˜•íƒœ: ë™ì‚¬(ã¦í˜•)ï¼‹ã‹ã‚‰. ì˜ë¯¸: ì–´ë–¤ í–‰ë™ì„ í•œ ë’¤ì— ë‹¤ìŒ í–‰ë™ì„ í•¨. ì˜ˆ: ë°¥ì„ ë¨¹ê³  ë‚˜ì„œ ê³µë¶€í•©ë‹ˆë‹¤."
  },
  "ã¦ã„ã‚‹": {
   ja: "ã€ã€œã¦ã„ã‚‹ã€‘å½¢ï¼šVï¼ˆã¦å½¢ï¼‰ï¼‹ã„ã‚‹ã€‚æ„å‘³ï¼šä»Šã—ã¦ã„ã‚‹ï¼ç¶šã„ã¦ã„ã‚‹çŠ¶æ…‹ã€‚ä¾‹ï¼šä»Šã€å‹‰å¼·ã—ã¦ã„ã¾ã™ã€‚",
   en: "Form: Verb (te-form) + imasu. Meaning: ongoing action or continuing state.",
   de: "Form: Verb (te-Form) + imasu. Bedeutung: andauernde Handlung oder Zustand.",
   ko: "í˜•íƒœ: ë™ì‚¬(ã¦í˜•)ï¼‹ã„ã¾ã™. ì˜ë¯¸: ì§„í–‰ ì¤‘ì´ê±°ë‚˜ ê³„ì†ë˜ëŠ” ìƒíƒœ."
  },
  "ãªãŒã‚‰": {
   ja: "ã€ã€œãªãŒã‚‰ã€‘å½¢ï¼šVï¼ˆã¾ã™å½¢ã®ã¾ã™ã‚’å–ã‚‹ï¼‰ï¼‹ãªãŒã‚‰ã€‚æ„å‘³ï¼š2ã¤ã®å‹•ä½œã‚’åŒæ™‚ã€‚ä¾‹ï¼šéŸ³æ¥½ã‚’èããªãŒã‚‰å‹‰å¼·ã—ã¾ã™ã€‚",
   en: "Form: Verb (masu-stem) + nagara. Meaning: doing two actions at the same time.",
   de: "Form: Verb (Masu-Stamm) + nagara. Bedeutung: zwei Handlungen gleichzeitig.",
   ko: "í˜•íƒœ: ë™ì‚¬(ã¾ã™í˜• ì–´ê°„)ï¼‹ãªãŒã‚‰. ì˜ë¯¸: ë‘ ê°€ì§€ í–‰ë™ì„ ë™ì‹œì— í•¨."
  },
  "ã“ã¨ãŒã‚ã‚‹": {
   ja: "ã€ã€œã“ã¨ãŒã‚ã‚‹ã€‘å½¢ï¼šVï¼ˆãŸå½¢ï¼‰ï¼‹ã“ã¨ãŒã‚ã‚‹ã€‚æ„å‘³ï¼šéå»ã®çµŒé¨“ãŒã‚ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ä¾‹ï¼šæ—¥æœ¬ã«è¡Œã£ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚",
   en: "Form: Verb (ta-form) + koto ga aru. Meaning: to talk about past experiences. Example: I have been to Japan.",
   de: "Form: Verb (ta-Form) + koto ga aru. Bedeutung: Ã¼ber frÃ¼here Erfahrungen sprechen. Beispiel: Ich war schon einmal in Japan.",
   ko: "í˜•íƒœ: ë™ì‚¬(ãŸí˜•)ï¼‹ã“ã¨ãŒã‚ã‚‹. ì˜ë¯¸: ê³¼ê±°ì˜ ê²½í—˜ì„ ë‚˜íƒ€ëƒ„. ì˜ˆ: ì¼ë³¸ì— ê°€ë³¸ ì ì´ ìˆìŠµë‹ˆë‹¤."
  },
  "ã“ã¨ãŒã§ãã‚‹": {
   ja: "ã€ã€œã“ã¨ãŒã§ãã‚‹ã€‘å½¢ï¼šVï¼ˆè¾æ›¸å½¢ï¼‰ï¼‹ã“ã¨ãŒã§ãã‚‹ã€‚æ„å‘³ï¼šèƒ½åŠ›ã‚„å¯èƒ½æ€§ã‚’è¡¨ã™ã€‚ä¾‹ï¼šæ—¥æœ¬èªã‚’è©±ã™ã“ã¨ãŒã§ãã¾ã™ã€‚",
   en: "Form: Verb (dictionary form) + koto ga dekiru. Meaning: expressing ability or possibility. Example: I can speak Japanese.",
   de: "Form: Verb (WÃ¶rterbuchform) + koto ga dekiru. Bedeutung: FÃ¤higkeit oder MÃ¶glichkeit ausdrÃ¼cken. Beispiel: Ich kann Japanisch sprechen.",
   ko: "í˜•íƒœ: ë™ì‚¬(ì‚¬ì „í˜•)ï¼‹ã“ã¨ãŒã§ãã‚‹. ì˜ë¯¸: ëŠ¥ë ¥ì´ë‚˜ ê°€ëŠ¥ì„±ì„ ë‚˜íƒ€ëƒ„. ì˜ˆ: ì¼ë³¸ì–´ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  },
  "ãŸã»ã†ãŒã„ã„": {
   ja: "ã€ã€œãŸã»ã†ãŒã„ã„ã€‘å½¢ï¼šVï¼ˆãŸå½¢ï¼‰ï¼‹ã»ã†ãŒã„ã„ã€‚æ„å‘³ï¼šåŠ©è¨€ãƒ»å‹§ã‚ã‚’è¡¨ã™è¨€ã„æ–¹ã€‚ä¾‹ï¼šæ—©ãå¯ãŸã»ã†ãŒã„ã„ã§ã™ã€‚",
   en: "Form: Verb (ta-form) + hou ga ii desu. Meaning: giving advice or a recommendation. Example: You should go to bed early.",
   de: "Form: Verb (ta-Form) + hou ga ii desu. Bedeutung: Ratschlag oder Empfehlung. Beispiel: Du solltest frÃ¼h schlafen gehen.",
   ko: "í˜•íƒœ: ë™ì‚¬(ãŸí˜•)ï¼‹ã»ã†ãŒã„ã„ã§ã™. ì˜ë¯¸: ì¡°ì–¸ì´ë‚˜ ê¶Œìœ ë¥¼ ë‚˜íƒ€ëƒ„. ì˜ˆ: ì¼ì° ìëŠ” ê²Œ ì¢‹ì•„ìš”." 
  },
  "ãŸã‚Š": {
   ja: "ã€ãŸã‚Šã€‘å½¢ï¼šVï¼ˆãŸå½¢ï¼‰ï¼‹ã‚Šã€Vï¼ˆãŸå½¢ï¼‰ï¼‹ã‚Šã—ã¾ã™ã€‚æ„å‘³ï¼šã„ãã¤ã‹ã®å‹•ä½œã‚„çŠ¶æ…‹ã‚’ä¾‹ã¨ã—ã¦æŒ™ã’ã‚‹è¨€ã„æ–¹ã€‚ä¾‹ï¼šé€±æœ«ã¯æ˜ ç”»ã‚’è¦‹ãŸã‚Šã€è²·ã„ç‰©ã‚’ã—ãŸã‚Šã—ã¾ã™ã€‚",
   en: "Form: Verb (ta-form) + ri, Verb (ta-form) + ri shimasu. Meaning: listing example actions or states. Example: On weekends, I watch movies and go shopping.",
   de: "Form: Verb (ta-Form) + ri, Verb (ta-Form) + ri shimasu. Bedeutung: beispielhaft mehrere Handlungen nennen. Beispiel: Am Wochenende schaue ich Filme und gehe einkaufen.",
   ko: "í˜•íƒœ: ë™ì‚¬(ãŸí˜•)ï¼‹ã‚Š, ë™ì‚¬(ãŸí˜•)ï¼‹ã‚Š í•©ë‹ˆë‹¤. ì˜ë¯¸: ì—¬ëŸ¬ í–‰ë™ì„ ì˜ˆë¡œ ë“¤ì–´ ë‚˜ì—´. ì˜ˆ: ì£¼ë§ì—ëŠ” ì˜í™”ë¥¼ ë³´ê±°ë‚˜ ì‡¼í•‘ì„ í•©ë‹ˆë‹¤."
  },
  "ã¦ãã ã•ã„": {
   ja: "ã€ã€œã¦ãã ã•ã„ã€‘å½¢ï¼šVï¼ˆã¦å½¢ï¼‰ï¼‹ãã ã•ã„ã€‚æ„å‘³ï¼šç›¸æ‰‹ã«ä½•ã‹ã‚’ä¾é ¼ã™ã‚‹ä¸å¯§ãªè¨€ã„æ–¹ã€‚ä¾‹ï¼šã“ã‚Œã‚’ãã ã•ã„ã€‚ãƒ‰ã‚¢ã‚’é–‹ã‘ã¦ãã ã•ã„ã€‚",
   en: "Form: Verb (te-form) + kudasai. Meaning: a polite request. Example: Please give me this. Please open the door.",
   de: "Form: Verb (te-Form) + kudasai. Bedeutung: hÃ¶fliche Bitte. Beispiel: Bitte geben Sie mir das. Bitte Ã¶ffnen Sie die TÃ¼r.",
   ko: "í˜•íƒœ: ë™ì‚¬(ã¦í˜•)ï¼‹ãã ã•ã„. ì˜ë¯¸: ì •ì¤‘í•œ ë¶€íƒ í‘œí˜„. ì˜ˆ: ì´ê²ƒì„ ì£¼ì„¸ìš”. ë¬¸ì„ ì—´ì–´ ì£¼ì„¸ìš”."
  },
  "ãªã„ã§ãã ã•ã„": {
   ja: "ã€ã€œãªã„ã§ãã ã•ã„ã€‘å½¢ï¼šVï¼ˆãªã„å½¢ï¼‰ï¼‹ã§ãã ã•ã„ã€‚æ„å‘³ï¼šç›¸æ‰‹ã«ã‚„ã‚ã¦ã»ã—ã„ã“ã¨ã‚’ä¸å¯§ã«ä¼ãˆã‚‹è¨€ã„æ–¹ã€‚ä¾‹ï¼šã“ã“ã§å†™çœŸã‚’æ’®ã‚‰ãªã„ã§ãã ã•ã„ã€‚",
   en: "Form: Verb (nai-form) + de kudasai. Meaning: politely asking someone not to do something. Example: Please do not take photos here.",
   de: "Form: Verb (nai-Form) + de kudasai. Bedeutung: hÃ¶flich bitten, etwas nicht zu tun. Beispiel: Bitte machen Sie hier keine Fotos.",
   ko: "í˜•íƒœ: ë™ì‚¬(ãªã„í˜•)ï¼‹ã§ãã ã•ã„. ì˜ë¯¸: í•˜ì§€ ë§ì•„ ë‹¬ë¼ê³  ì •ì¤‘íˆ ìš”ì²­. ì˜ˆ: ì—¬ê¸°ì„œ ì‚¬ì§„ì„ ì°ì§€ ë§ì•„ ì£¼ì„¸ìš”."
  }, 
  "ã™ãã‚‹": {
   ja: "ã€ã€œã™ãã‚‹ã€‘å½¢ï¼šVï¼ˆã¾ã™å½¢ã®ã¾ã™ã‚’å–ã‚‹ï¼‰ï¼‹ã™ãã‚‹ï¼ã„å½¢å®¹è©ï¼ˆã„â†’ãï¼‰ï¼‹ã™ãã‚‹ï¼ãªå½¢å®¹è©ï¼‹ã™ãã‚‹ã€‚æ„å‘³ï¼šç¨‹åº¦ãŒåº¦ã‚’ã“ãˆã¦ã„ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ä¾‹ï¼šé£Ÿã¹ã™ãã¾ã—ãŸã€‚é«˜ã™ãã¾ã™ã€‚",
   en: "Form: Verb (masu-stem) + sugiru / i-adjective (iâ†’ku) + sugiru / na-adjective + sugiru. Meaning: expressing excess. Example: I ate too much. Itâ€™s too expensive.",
   de: "Form: Verb (Masu-Stamm) + sugiru / i-Adjektiv (iâ†’ku) + sugiru / na-Adjektiv + sugiru. Bedeutung: ÃœbermaÃŸ ausdrÃ¼cken. Beispiel: Ich habe zu viel gegessen. Es ist zu teuer.",
   ko: "í˜•íƒœ: ë™ì‚¬(ã¾ã™í˜• ì–´ê°„)ï¼‹ã™ãã‚‹ / ã„í˜•ìš©ì‚¬(ã„â†’ã)ï¼‹ã™ãã‚‹ / ãªí˜•ìš©ì‚¬ï¼‹ã™ãã‚‹. ì˜ë¯¸: ì •ë„ê°€ ì§€ë‚˜ì¹¨. ì˜ˆ: ë„ˆë¬´ ë§ì´ ë¨¹ì—ˆì–´ìš”. ë„ˆë¬´ ë¹„ì‹¸ìš”."
  }, 
  "ã§ã—ã‚‡ã†": {
   ja: "ã€ã€œã§ã—ã‚‡ã†ã€‘å½¢ï¼šæ™®é€šå½¢ï¼‹ã§ã—ã‚‡ã†ã€‚æ„å‘³ï¼šè©±ã—æ‰‹ã®æ¨é‡ã‚„ã€ç›¸æ‰‹ã®åŒæ„ã‚’ã‚„ã‚ã‚‰ã‹ãæ±‚ã‚ã‚‹è¨€ã„æ–¹ã€‚ä¾‹ï¼šæ˜æ—¥ã¯é›¨ã§ã—ã‚‡ã†ã€‚ãã‚Œã„ã§ã—ã‚‡ã†ï¼Ÿ",
   en: "Form: Plain form + deshou. Meaning: expressing probability or softly seeking agreement. Example: It will probably rain tomorrow. Nice, isnâ€™t it?",
   de: "Form: Grundform + deshou. Bedeutung: Vermutung ausdrÃ¼cken oder Zustimmung sanft einholen. Beispiel: Morgen wird es wohl regnen. SchÃ¶n, oder?",
   ko: "í˜•íƒœ: ë³´í†µí˜•ï¼‹ã§ã—ã‚‡ã†. ì˜ë¯¸: ì¶”ì¸¡ì„ ë‚˜íƒ€ë‚´ê±°ë‚˜ ìƒëŒ€ì˜ ë™ì˜ë¥¼ ë¶€ë“œëŸ½ê²Œ êµ¬í•¨. ì˜ˆ: ë‚´ì¼ì€ ë¹„ê°€ ì˜¤ê² ì§€ìš”? ì˜ˆì˜ì£ ?"
  },
  "ã‚ˆã¦ã„": {
   ja: "ã€ã€œã‚ˆã¦ã„ã€‘å½¢ï¼šNï¼‹ã®ï¼‹ã‚ˆã¦ã„ã§ã™ï¼Vï¼ˆè¾æ›¸å½¢ï¼‰ï¼‹ã‚ˆã¦ã„ã§ã™ã€‚æ„å‘³ï¼šã‚ã‚‰ã‹ã˜ã‚æ±ºã¾ã£ã¦ã„ã‚‹è¨ˆç”»ã‚’è¡¨ã™ã€‚ä¾‹ï¼šæ¥é€±ã€æ—¥æœ¬ã¸è¡Œãã‚ˆã¦ã„ã§ã™ã€‚",
   en: "Form: N + no + yotei desu / Verb (dictionary form) + yotei desu. Meaning: a planned schedule or intention. Example: I plan to go to Japan next week.",
   de: "Form: N + no + yotei desu / Verb (WÃ¶rterbuchform) + yotei desu. Bedeutung: fest geplanter Termin oder Plan. Beispiel: Ich habe vor, nÃ¤chste Woche nach Japan zu fahren.",
   ko: "í˜•íƒœ: ëª…ì‚¬ï¼‹ã®ï¼‹ã‚ˆã¦ã„ã§ã™ / ë™ì‚¬(ì‚¬ì „í˜•)ï¼‹ã‚ˆã¦ã„ã§ã™. ì˜ë¯¸: ë¯¸ë¦¬ ì •í•´ì§„ ê³„íš. ì˜ˆ: ë‹¤ìŒ ì£¼ì— ì¼ë³¸ì— ê°ˆ ì˜ˆì •ì…ë‹ˆë‹¤."
  },
  "ã¤ã‚‚ã‚Š": {
   ja: "ã€ã€œã¤ã‚‚ã‚Šã€‘å½¢ï¼šVï¼ˆè¾æ›¸å½¢ï¼ãªã„å½¢ï¼‰ï¼‹ã¤ã‚‚ã‚Šã§ã™ã€‚æ„å‘³ï¼šè©±ã—æ‰‹ã®æ„å¿—ã‚„äºˆå®šã‚’è¡¨ã™ã€‚ä¾‹ï¼šæ˜æ—¥ã€æ—©ãèµ·ãã‚‹ã¤ã‚‚ã‚Šã§ã™ã€‚",
   en: "Form: Verb (dictionary form / nai-form) + tsumori desu. Meaning: expressing the speakerâ€™s intention or plan. Example: I intend to wake up early tomorrow.",
   de: "Form: Verb (WÃ¶rterbuchform / nai-Form) + tsumori desu. Bedeutung: Absicht oder Plan des Sprechers. Beispiel: Ich habe vor, morgen frÃ¼h aufzustehen.",
   ko: "í˜•íƒœ: ë™ì‚¬(ì‚¬ì „í˜•/ãªã„í˜•)ï¼‹ã¤ã‚‚ã‚Šì…ë‹ˆë‹¤. ì˜ë¯¸: ë§í•˜ëŠ” ì‚¬ëŒì˜ ì˜ë„ë‚˜ ê³„íš. ì˜ˆ: ë‚´ì¼ ì¼ì° ì¼ì–´ë‚  ìƒê°ì…ë‹ˆë‹¤."
  },
  "ã§ãã‚‹": {
  ja: "ã€ã€œã§ãã‚‹ã€‘å½¢ï¼šåè©ï¼‹ãŒï¼‹ã§ãã‚‹ã€‚æ„å‘³ï¼šèƒ½åŠ›ã‚„ç‰¹æŠ€ãŒã‚ã‚‹ã“ã¨ã‚’è¡¨ã™ã€‚ä¾‹ï¼šãƒ”ã‚¢ãƒãŒã§ãã¾ã™ã€‚ã‚¹ã‚­ãƒ¼ãŒã§ãã¾ã™ã€‚",
  en: "Form: noun + ga + dekiru. Meaning: expresses ability or skill. Example: I can play the piano. I can ski.",
  de: "Form: Nomen + ga + dekiru. Bedeutung: drÃ¼ckt FÃ¤higkeit oder KÃ¶nnen aus. Beispiel: Ich kann Klavier spielen. Ich kann Ski fahren.",
  ko: "í˜•íƒœ: ëª…ì‚¬ï¼‹ãŒï¼‹ã§ãã‚‹. ì˜ë¯¸: ëŠ¥ë ¥ì´ë‚˜ íŠ¹ê¸°ê°€ ìˆìŒì„ ë‚˜íƒ€ëƒ„. ì˜ˆ: í”¼ì•„ë…¸ë¥¼ ì¹  ìˆ˜ ìˆì–´ìš”. ìŠ¤í‚¤ë¥¼ íƒˆ ìˆ˜ ìˆì–´ìš”."
 }
};
const APPLIED_REVIEW_TEXT = {
  ja: {
    title: "ã“ã“ã¾ã§ã®æŒ¯ã‚Šè¿”ã‚Š",
    score: (n) => `æ­£è§£æ•°ï¼š${n} / 3`,
    c3: "ã‚ˆãã§ãã¦ã„ã‚‹ï¼\nã“ã®æ–‡æ³•ã€ã‹ãªã‚Šèº«ã«ã¤ã„ã¦ãã¦ã„ã¾ã™ã€‚",
    c2: "ã ã„ã¶ã„ã„ãï¼\nã‚ã¨å°‘ã—ã§å®‰å®šã—ãã†ã§ã™ã€‚",
    c1: "ã‚‚ã†å°‘ã—å¾©ç¿’ã—ã¦ã¿ã‚ˆã†ã€‚\nãƒã‚¤ãƒ³ãƒˆã‚’è¦‹ç›´ã™ã¨ã‚ˆããªã‚Šã¾ã™ã€‚",
    next3: "æ¬¡ã®3å•ã¸"   // â†â˜…è¿½åŠ 
  },
  en: {
    title: "Review so far",
    score: (n) => `Correct: ${n} / 3`,
    c3: "Great job!\nYou're getting solid with this grammar.",
    c2: "Pretty good!\nJust a bit more to stabilize.",
    c1: "Letâ€™s review a bit more.\nRecheck the key points.",
    next3: "Next 3 questions"
  },
  de: {
    title: "Zwischenbilanz",
    score: (n) => `Richtig: ${n} / 3`,
    c3: "Sehr gut!\nDiese Grammatik sitzt schon gut.",
    c2: "Schon ziemlich gut!\nFast stabil.",
    c1: "Noch etwas wiederholen.\nDie Kernpunkte prÃ¼fen.",
    next3: "NÃ¤chste 3 Fragen"
  },
  ko: {
    title: "ì§€ê¸ˆê¹Œì§€ì˜ ë³µìŠµ",
    score: (n) => `ì •ë‹µ ìˆ˜: ${n} / 3`,
    c3: "ì•„ì£¼ ì¢‹ì•„ìš”. ì´ ë¬¸ë²•ì€ ì˜ ì´í•´í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
    c2: "ëŒ€ì²´ë¡œ ê´œì°®ì•„ìš”. ì¡°ê¸ˆë§Œ ë” ë³µìŠµí•´ ë´…ì‹œë‹¤.",
    c1: "ì•„ì§ ì¡°ê¸ˆ í—·ê°ˆë¦´ ìˆ˜ ìˆì–´ìš”. ì˜ˆë¬¸ì„ ë‹¤ì‹œ í™•ì¸í•´ ë³´ì„¸ìš”.",
    next3: "ë‹¤ìŒ 3ë¬¸ì œ"
  }
};

/** =========================
 *  çŠ¶æ…‹
 * ========================= */
let questions = [];
let current = 0;
let selectedIndex = null;
let currentExplanationQuestion = null;
let currentExplanationBox = null;

let isAppliedReviewScreen = false;
let appliedReviewData = null;  
// è¨ºæ–­ç”¨ï¼šå›ç­”ãƒ­ã‚°
// {id, correct, grammar_group, grammar_item, type}
let results = [];

window.practiceMode = false;

/** =========================
 *  DOM
 * ========================= */
// â˜…è¿½åŠ ï¼šåŒã˜æ–‡æ³•ã‚°ãƒ«ãƒ¼ãƒ—ãŒé€£ç¶šã—ãªã„ã‚ˆã†ã«ã‚·ãƒ£ãƒƒãƒ•ãƒ«
function shuffleQuestionsAvoidSameGroup(list){
  if(!Array.isArray(list) || list.length <= 1) return;

  // é€šå¸¸ã‚·ãƒ£ãƒƒãƒ•ãƒ«
  for(let i=list.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [list[i],list[j]]=[list[j],list[i]];
  }

  // é€£ç¶šå›é¿
  for(let i=1;i<list.length;i++){
    if(list[i].grammar_group === list[i-1].grammar_group){
      for(let j=i+1;j<list.length;j++){
        if(list[j].grammar_group !== list[i-1].grammar_group){
          [list[i],list[j]]=[list[j],list[i]];
          break;
        }
      }
    }
  }
}
// â˜…è¿½åŠ ï¼šé¸æŠè‚¢ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã€answer(index)ã‚’è¿½å¾“ã•ã›ã‚‹

// â˜…è¿½åŠ ï¼šé¸æŠè‚¢ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã€answer(index)ã‚’è¿½å¾“ã•ã›ã‚‹

// â˜…é¸æŠè‚¢ï¼‹ç­”ãˆã‚·ãƒ£ãƒƒãƒ•ãƒ«ç”¨
function shuffleChoicesWithAnswer(q){
  const pairs = (q?.choices ?? []).map((text, idx)=>({ text, idx }));

  for(let i=pairs.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [pairs[i], pairs[j]] = [pairs[j], pairs[i]];
  }

  return {
    choices: pairs.map(p=>p.text),
    answer: pairs.findIndex(p=>p.idx === q?.answer)
  };
}

const el = (id)=>document.getElementById(id);
const qEl = el("q");
const choicesEl = el("choices");
const nextBtn = el("next");
const progressEl = el("progress");
const statusEl = el("status");
const readyEl = el("readyStatus");
const modePill = el("modePill");
const groupPill = el("groupPill");
const typePill = el("typePill");
const testView = el("testView");
const resultView = el("resultView");

function pick40Questions(allQuestions){
  const pool = allQuestions.filter(q => q && q.question);

  for(let i = pool.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [pool[i], pool[j]] = [pool[j], pool[i]];
  }

  return pool.slice(0, 40);
}

/** =========================
 *  èª­ã¿è¾¼ã¿
 * ========================= */

 fetch("questions_all.json")
  .then(r=>{
    if(!r.ok) throw new Error("Fetch failed: " + r.status);
    return r.json();
  })
  .then(data=>{
    const allQuestions = data.questions ?? data;
    if(!Array.isArray(allQuestions) || allQuestions.length === 0) {
      throw new Error("questions_all.json ã®å½¢å¼ãŒä¸æ­£ï¼ˆquestionsé…åˆ—ãŒãªã„ï¼‰");
    }

    // â˜… ã“ã“ã‚’è¿½åŠ 
    window.allQuestions = allQuestions;
    window.allQuestionsLoaded = true;
    questions = pick40Questions(allQuestions);
    console.log("â˜…â˜… CHECK questions â˜…â˜…", questions.length, questions);


    console.log(
      questions.reduce((m,q)=>{
       (q.tags?.grammar||[]).forEach(g=>m[g]=(m[g]||0)+1);
       return m;
   },{})
 );

  // å®‰å…¨ãƒã‚§ãƒƒã‚¯ï¼ˆå¿…é ˆï¼‰
  // if (questions.length !== 40) {
  //  throw new Error("æŠ½å‡ºçµæœãŒ40å•ã§ã¯ã‚ã‚Šã¾ã›ã‚“: " + questions.length);
  //
  shuffleQuestionsAvoidSameGroup(questions);

    document.getElementById("readyStatus").textContent = "æº–å‚™OK / Ready";

    readyEl.textContent = "æº–å‚™OK / Ready"; 
    // if (!window.practiceMode) {
   //   renderQuestion();
   // }

  })
  .catch(e=>{
    statusEl.innerHTML = '<span class="bad">JSONèª­ã‚ã¦ãªã„ï¼ˆConsoleå‚ç…§ï¼‰</span>';
    qEl.textContent = "ã‚¨ãƒ©ãƒ¼ï¼šquestions_40.json ã‚’èª­ã‚ã¾ã›ã‚“";
    console.error(e);
  });
  
  function startPractice() {

    window.practiceMode = true;
    modePill.textContent = "å¼·åŒ–ç·´ç¿’";
    current = 0;
    results = [];

    if (!window.practiceConfig) {
     alert("è¨­å®šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
    return;
 }
  const PRACTICE_COUNT = 10; // â˜… å¼·åŒ–ç·´ç¿’ã¯å¸¸ã«10å•
  

  const { groups } = window.practiceConfig;

  fetch ("questions_all.json")
    .then(r => {
      if (!r.ok) throw new Error("Fetch failed");
      return r.json();
    })
    .then(data => {
      const all = data.questions ?? data;
      if (!Array.isArray(all) || all.length === 0) {
        throw new Error("å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒç©ºã§ã™");
      }

      let pool = all.filter(q => {
        const g = q?.grammar_group;
        return g && groups.includes(g);
      });

      if (pool.length === 0) {
        alert("é¸ã‚“ã ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®å•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“");
        return;
      }

      for (let i = pool.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [pool[i], pool[j]] = [pool[j], pool[i]];
      }

      const actualCount = Math.min(PRACTICE_COUNT, pool.length);
      questions = pool.slice(0, actualCount);

      current = 0;
      selectedIndex = null;
      results = [];

      document.getElementById("practiceSetup").style.display = "none";
      testView.style.display = "block";
      resultView.style.display = "none";

      shuffleQuestionsAvoidSameGroup(questions);
      renderQuestion();
    })
    .catch(err => {
      console.error(err);
      alert("å¼·åŒ–ç·´ç¿’ã®é–‹å§‹ã«å¤±æ•—ã—ã¾ã—ãŸ");
    });
}

/** =========================
 *  è¡¨ç¤ºï¼šå•é¡Œ
 * ========================= */
 function renderQuestion() {

  // â˜…å¿œç”¨ç·´ç¿’ä¸­ã¯é€šå¸¸å•é¡Œã‚’æç”»ã—ãªã„ï¼ˆæ··ç·šé˜²æ­¢ï¼‰
  if (window.practiceMode === "APPLIED") return;
// â˜… â‘¡-B å®‰å…¨è£…ç½®ï¼ˆæœ€é‡è¦ï¼‰
  if (!questions || !questions[current]) {
  console.warn("Invalid question state", { questions, current });
  return;
}

nextBtn.style.display = "inline-block";
nextBtn.disabled = true;

console.log("renderQuestion called");

statusEl.textContent = "";
selectedIndex = null;
nextBtn.disabled = true;

const q = questions[current];

// é€²æ—è¡¨ç¤º
progressEl.textContent = `${current + 1} / ${questions.length} questions`;

// æ–‡æ³•ã‚°ãƒ«ãƒ¼ãƒ—è¡¨ç¤º
const gg = q.grammar_group ?? "UNCLASSIFIED";
if (groupPill) {
  groupPill.textContent =
    DIAG_TEXT[currentLang]?.groups?.[gg] ?? gg;
}


  // å•é¡Œã‚¿ã‚¤ãƒ—è¡¨ç¤º
  const t = q.type ?? "MC";
  typePill.textContent =
    t === "STAR"
      ? "â˜…ä¸¦ã³æ›¿ãˆ / Word Order"
      : "å››æŠ / Multiple Choice";

  // å•é¡Œæ–‡
  qEl.innerHTML = (q.question ?? "ï¼ˆå•é¡Œæ–‡ãªã—ï¼‰").replace(
    /ï¼ˆ\s*ï¼‰/g,
    '<span class="blank">ï¼ˆã€€ã€€ï¼‰</span>'
  );

  // =========================
  // â˜… é¸æŠè‚¢ï¼‹ç­”ãˆã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼ˆâ€»ã“ã“ã ã‘ï¼‰
  // =========================
  const shuffled = shuffleChoicesWithAnswer(q);
  q._shuffledAnswer = shuffled.answer;

  // é¸æŠè‚¢æç”»ï¼ˆâ€»1å›ã ã‘ï¼‰
  choicesEl.innerHTML = "";

  shuffled.choices.forEach((text, idx) => {
    const d = document.createElement("div");
    d.className = "choice";
    d.textContent = text;

    d.onclick = () => {
      document
        .querySelectorAll(".choice")
        .forEach(x => x.classList.remove("selected"));
      d.classList.add("selected");
      selectedIndex = idx;
      nextBtn.disabled = false;
    };

    choicesEl.appendChild(d);
  });
}


/** =========================
 *  è§£ç­”ä¿å­˜ â†’ æ¬¡ã¸
 * ========================= */
 function mainNextHandler() {

    // â˜…å¿œç”¨ç·´ç¿’ä¸­ã¯é€šå¸¸ã® next å‡¦ç†ã‚’ã—ãªã„ï¼ˆæ··ç·šé˜²æ­¢ï¼‰
    if (window.practiceMode === "APPLIED") return;

    if (selectedIndex === null) return;

    const q = questions[current];
    const correct = (selectedIndex === (q._shuffledAnswer ?? q.answer));

  results.push({
    id: q.id ?? `Q_${current+1}`,
    correct,
    grammar_group: q.grammar_group ?? "UNCLASSIFIED",
    grammar_item: q.grammar_item ?? q.intent ?? "ï¼ˆä¸æ˜ï¼‰",
    type: q.type ?? "MC"
  });

  current++;

  if (current < questions.length) {
    renderQuestion();
  } else {
    if (window.practiceMode === true) {
      showPracticeResult();
    } else {
      showDiagnosis();
    }
  }
}

// â˜… ã“ã‚Œã‚’å¿…ãšæ›¸ã
nextBtn.onclick = mainNextHandler;

/** =========================
 *  è¨ºæ–­ç”»é¢ï¼ˆã‚ãªãŸã®ä»•æ§˜ã©ãŠã‚Šï¼‰
 * ========================= */
/** =========================
 *  è¨ºæ–­ç”»é¢ï¼ˆãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯å°‚ç”¨ï¼‰
 * ========================= */
 function showDiagnosis(){
  window.lastDiagnosisResult = true;
  const T = DIAG_TEXT[currentLang] ?? DIAG_TEXT.ja;

  modePill.textContent = T.result;
  testView.style.display = "none";
  resultView.style.display = "block";

  const total = results.length;
  const correctCount = results.filter(r=>r.correct).length;
  const rate = Math.round((correctCount / total) * 100);
  const overallColor = rate >= 65 ? "high" : rate >= 30 ? "mid" : "low";
  const judge = OVERALL_JUDGE(rate);

  // ã‚°ãƒ«ãƒ¼ãƒ—é›†è¨ˆ
  const groupStat = {};
  GROUP_ORDER.forEach(g=> groupStat[g] = { total:0, correct:0 });

  results.forEach(r=>{
    if(!groupStat[r.grammar_group]) groupStat[r.grammar_group] = { total:0, correct:0 };
    groupStat[r.grammar_group].total++;
    if(r.correct) groupStat[r.grammar_group].correct++;
  });

  // é–“é•ã„æŠ½å‡ºï¼ˆæ–‡æ³•ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ï¼‰
  const wrong = results.filter(r=>!r.correct);
  const wrongByItem = {};
  wrong.forEach(r=>{
    const key = r.grammar_item || "ï¼ˆä¸æ˜ï¼‰";
    wrongByItem[key] = (wrongByItem[key] || 0) + 1;
  });
  let judgeMark = "";
  if (judge.cls === "high") judgeMark = "ğŸŒ¸ ";
  else if (judge.cls === "mid") judgeMark = "âš ï¸ ";
  else if (judge.cls === "low") judgeMark = "â— ";
  // --- å‡ºåŠ› ---
  let html = `
    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <h2 class="h2">${T.result}</h2>
        <span class="pill">${T.passline}</span>
      </div>

      <div class="kpi">${correctCount} / ${total}ï¼ˆ${rate}%ï¼‰</div>
      <div class="score-bar">
        <div class="score-bar-fill ${overallColor}" style="width:${rate}%"></div>
      </div>

      <p class="${judge.cls}" style="font-weight:700;margin:6px 0 2px;">
        ${judgeMark}${T.judge[judge.cls]}
      </p>
      <p style="margin:0;">
        ${T.judge[judge.cls + "Msg"]}
      </p>
    </div>

    <div class="card">
      <h2 class="h2">${T.grammarLevel}</h2>
      <p class="muted" style="margin:0 0 6px;">${T.legend}</p>

      <div class="cat-bars">
        ${
          GROUP_ORDER.map(g=>{
            const st = groupStat[g];
            if(!st || st.total === 0) return "";
            const gr = Math.round((st.correct / st.total) * 100);
            const cls = gr >= 65 ? "high" : gr >= 30 ? "mid" : "low";
            const label = T?.groups?.[g] ?? g;

            return `
              <div class="cat-item">
                <span>${label}</span>
                <div class="bar"><div class="fill ${cls}" style="width:${gr}%"></div></div>
                <span class="pct">${T.rate(gr, st.correct, st.total)}</span>
              </div>
            `;
          }).join("")
        }
      </div>

      <div class="weak-summary">
       
        <p class="level-desc">
          ${
            rate >= 80 ? T.levelWord.high
            : rate >= 50 ? T.levelWord.mid
            : rate >= 30 ? T.levelWord.low
            : T.levelWord.veryLow
          }
        </p>
      </div>
    </div>
  `;

  // ã‚°ãƒ«ãƒ¼ãƒ—åˆ¥ã®èª¬æ˜ï¼ˆ100%ã¯å‡ºã•ãªã„ï¼‰
  GROUP_ORDER.forEach(g=>{
    const st = groupStat[g];
    if(!st || st.total === 0) return;

    const gr = Math.round((st.correct / st.total) * 100);
    const level =
      T?.levelWord
        ? (gr >= 65 ? T.levelWord.high : gr >= 30 ? T.levelWord.mid : T.levelWord.low)
        : LEVEL_WORD(gr);

    const label = T?.groups?.[g] ?? g;

    html += `
      <div style="margin:12px 0;">
        <h3 class="h3">${label}</h3>
        <p style="margin:2px 0;">${T.score}ï¼š${st.correct} / ${st.total}</p>
        <p style="margin:2px 0;">${T.levelLabel}ï¼š${level}</p>
    `;

    if (gr !== 100) {
      const hint =
        DIAG_TEXT[currentLang]?.groupHint?.[g]?.[currentLang]
        ?? DIAG_TEXT[currentLang]?.groupHint?.[g]?.ja
        ?? "";

      if (hint) html += `<p style="margin:6px 0 0;">${hint}</p>`;
    }

    html += `</div>`;
  });

  // STEP Cï¼šé–“é•ãˆãŸæ–‡æ³•ã ã‘å€‹åˆ¥èª¬æ˜ï¼ˆã‚ã‚‹ã‚‚ã®ã ã‘ï¼‰
  if (wrong.length > 0) {
    html += `
      <div class="card">
        <h2 class="h2">${T.review}</h2>
    `;

    const items = Object.entries(wrongByItem).sort((a,b)=>b[1]-a[1]);
    items.forEach(([item, cnt])=>{
      const explRaw = GRAMMAR_EXPLAIN[item];
      const expl =
        typeof explRaw === "string"
          ? explRaw
          : (explRaw?.[currentLang] ?? explRaw?.ja ?? "");

      if (!expl) return;

      html += `
        <div class="card" style="border-color:#eee;background:#fafafa;">
          <div class="row" style="justify-content:space-between;">
            <div style="font-weight:700;">${item}</div>
            <div class="pill">${T.miss}ï¼š${cnt}</div>
          </div>
          <p style="margin:8px 0 0;">${expl}</p>
        </div>
      `;
    });

    html += `</div>`;
  } else {
    html += `
      <div class="card">
        <h2 class="h2">${T.review}</h2>
        <p style="margin:0;" class="good">${T.perfect ?? "Perfect!"}</p>
      </div>
    `;
  }

  // å†ã‚¹ã‚¿ãƒ¼ãƒˆ
  html += `
    <div class="card">
      <button id="restart">${T.retry}</button>
      <div class="muted" style="margin-top:8px;font-size:12px;">
        ${T.noteShuffle}
      </div>
    </div>
  `;

  resultView.innerHTML = html;

  // â˜… restart ã¯ showDiagnosis ã®ä¸­ã§å¿…ãšç´ä»˜ã‘ã‚‹ï¼ˆå¤–ã«å‡ºã™ã¨å£Šã‚Œã‚‹ï¼‰
  const restartBtn = document.getElementById("restart");
  if (restartBtn) {
    restartBtn.onclick = ()=>{
      results = [];
      current = 0;
      selectedIndex = null;

      const T2 = DIAG_TEXT[currentLang] ?? DIAG_TEXT.ja;
      modePill.textContent = T2.test;

      testView.style.display = "block";
      resultView.style.display = "none";
      renderQuestion();
    };
  }
}


/** =========================
 *  å¼·åŒ–ç·´ç¿’ã®çµæœï¼ˆå¼·åŒ–ç·´ç¿’å°‚ç”¨ï¼‰
 * ========================= */
 function showPracticeResult() {
  testView.style.display = "none";
  resultView.style.display = "block";

  const T = DIAG_TEXT[currentLang] ?? DIAG_TEXT.ja;

  const total = results.length;
  const correctCount = results.filter(r => r.correct).length;

  const judge = OVERALL_JUDGE(
  total === 0 ? 0 : Math.round((correctCount / total) * 100)
 );
  const wrong = results.filter(r => !r.correct);
  const wrongByItem = {};
  wrong.forEach(r => {
    const key = r.grammar_item || "ï¼ˆä¸æ˜ï¼‰";
    wrongByItem[key] = (wrongByItem[key] || 0) + 1;
  });

  let html = `
   <div class="card">
     <h2 class="h2">${T.result}</h2>
     <div class="kpi">${correctCount} / ${total}</div>

    <div class="overall ${judge.cls}">
      ${T.judge?.[judge.key + "Msg"]
        ?? DIAG_TEXT.ja?.judge?.[judge.key + "Msg"]
        ?? ""}
    </div>

    <div class="row" style="gap:10px;flex-wrap:wrap;margin-top:10px;">
      <button id="retryPractice">ã‚‚ã†ä¸€åº¦</button>
    </div>
  </div>
`; 

  if (wrong.length > 0) {
    html += `
     <div class="card">
      ${T.wrongTitle ? `<h3 class="h3">${T.wrongTitle}</h3>` : ""}
    `;

    Object.entries(wrongByItem)
      .sort((a,b)=>b[1]-a[1])
      .forEach(([item, cnt]) => {

        const explRaw = GRAMMAR_EXPLAIN[item];   // â˜… ã“ã‚ŒãŒæŠœã‘ã¦ã„ãŸ
        const expl =
         typeof explRaw === "string"
         ? explRaw
         : (explRaw?.[currentLang] ?? explRaw?.ja ?? "No grammar explanation");

        html += `
          <div class="card" style="border-color:#eee;background:#fafafa;">
            <div class="row" style="justify-content:space-between;">
              <div style="font-weight:700;">${item}</div>
              <div class="pill">${T.miss}ï¼š${cnt}</div>
            </div>
            <p style="margin:8px 0 0;">
              ${expl ? expl : T.noExplain}
            </p>
          </div>
        `;
      });

    html += `</div>`;
  }

  resultView.innerHTML = html;

  // ãƒã‚¤ãƒ³ãƒ‰ã¯ã€Œæç”»ç›´å¾Œã€ã«1å›ã ã‘
  const retryBtn = document.getElementById("retryPractice");
  if (retryBtn) {
    retryBtn.onclick = () => {
      resultView.style.display = "none";
      document.getElementById("practiceSetup").style.display = "block";

      setLang(currentLang); // â˜… å¿œç”¨ç·´ç¿’ã®èª¬æ˜æ–‡ã«è¨€èªã‚’å½“ã¦ç›´ã™
   };
  }
}

</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    console.log("goMain =", document.getElementById("goMain"));


    const btnA = document.getElementById("btnA");
    const toPage3 = document.getElementById("toPage3");
    const page1 = document.getElementById("page1"); 
    const page2 = document.getElementById("page2");
    const menu = document.getElementById("menu");
    const testView = document.getElementById("testView");
    const btnC = document.getElementById("btnC");
    
    const goMainBtn = document.getElementById("goMain");
if (goMainBtn) {
  goMainBtn.onclick = () => {
    page1.style.display = "block";
    menu.style.display = "block";

    page2.style.display = "none";
    testView.style.display = "none";
    document.getElementById("practiceSetup")?.style && (document.getElementById("practiceSetup").style.display = "none");
    document.getElementById("resultView")?.style && (document.getElementById("resultView").style.display = "none");

    // â‘¢-A çŠ¶æ…‹ã‚’å®Œå…¨ãƒªã‚»ãƒƒãƒˆï¼ˆæ··åœ¨é˜²æ­¢ï¼‰
    window.practiceMode = false;
    window.practiceConfig = null;

    // questions = [];
    // results = [];

    window.lastDiagnosisResult = false;
    
    current = 0;
    selectedIndex = null;
    
    // ===== å¿œç”¨ç·´ç¿’ã®çŠ¶æ…‹ã‚’å®Œå…¨ãƒªã‚»ãƒƒãƒˆï¼ˆâ˜…è¿½åŠ ï¼‰=====
    window.practiceMode = "NORMAL";
    isAppliedReviewScreen = false;
    appliedReviewData = null;
    isAppliedFinished = false;
    appliedIndex = 0;
    appliedBlockCorrect = 0;

    // next ãƒœã‚¿ãƒ³ã‚’é€šå¸¸ç”¨ã«æˆ»ã™
    nextBtn.onclick = mainNextHandler;
    nextBtn.textContent = "æ¬¡ã¸";
  };
}
    // â‘  1ãƒšãƒ¼ã‚¸ç›® â†’ 2ãƒšãƒ¼ã‚¸ç›®
  if (btnA) {
    btnA.onclick = () => {
    page2.style.display = "block";
    menu.style.display = "none";

    // â˜… è¡¨ç¤ºãŒç¢ºå®šã—ãŸã€Œæ¬¡ã®ãƒ•ãƒ¬ãƒ¼ãƒ ã€ã§è¨€èªã‚’å½“ã¦ç›´ã™
    requestAnimationFrame(() => {
      setLang(currentLang);
    });
  };
}
  
    // â‘¡ 2ãƒšãƒ¼ã‚¸ç›® â†’ 3ãƒšãƒ¼ã‚¸ç›®
    if (toPage3) {
    toPage3.onclick = () => {

    // â‘  UIåˆ‡æ›¿ï¼ˆä»Šã®ã¾ã¾ï¼‰
    window.practiceMode = false;
    modePill.textContent = "ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯";

    page2.style.display = "none";
    page1.style.display = "none";
    testView.style.display = "block";
    const rv = document.getElementById("resultView");
    if (rv) rv.style.display = "none";

    setLang(currentLang);

    // â‘¡-A â˜…ã‚¬ãƒ¼ãƒ‰ï¼šå•é¡Œãƒ‡ãƒ¼ã‚¿ãŒæœªæº–å‚™ãªã‚‰æ­¢ã‚ã‚‹
    if (!window.allQuestions || window.allQuestions.length === 0) {
      alert("å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™ã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
      return;
    }

    // â‘¡-A â˜…å¿…ãšã€Œ40å•ã®ãƒ¬ãƒ™ãƒ«ãƒã‚§ãƒƒã‚¯å•é¡Œã€ã‚’ä½œã‚Šç›´ã™ï¼ˆæ··ã–ã‚Šé˜²æ­¢ï¼‰
    questions = pick40Questions(window.allQuestions);
    shuffleQuestionsAvoidSameGroup(questions);

    // â‘¢ åˆæœŸåŒ–ï¼ˆæ··ã–ã‚Šé˜²æ­¢ã®æ ¸å¿ƒï¼‰
    current = 0;
    selectedIndex = null;
    results = [];
    

    // â˜… ãƒ¡ã‚¤ãƒ³ã«æˆ»ã‚‹ã¨ãã¯å¿…ãšé€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã™ï¼ˆæœ€é‡è¦ï¼‰
    window.practiceMode = "NORMAL";
    isAppliedFinished = false;
    appliedIndex = 0;

    // âœ… è¿½åŠ ï¼šå¿œç”¨ç·´ç¿’ãŒä¸Šæ›¸ãã—ãŸ nextBtn ã‚’æˆ»ã™
    nextBtn.textContent = "æ¬¡ã¸";
    nextBtn.onclick = mainNextHandler;   // â† ä¸‹ã§ä½œã‚‹é–¢æ•°å
    isAppliedReviewScreen = false;

    // â‘£ 1å•ç›®è¡¨ç¤º
    renderQuestion();
  };
}

    if (btnC) {
      btnC.onclick = () => {
      page1.style.display = "none";
      page2.style.display = "none";
      menu.style.display = "none";
      testView.style.display = "none";

      document.getElementById("practiceSetup").style.display = "block";
      setLang(currentLang);
  };
}
    // ===== å¼·åŒ–ç·´ç¿’ STARTï¼ˆä¿®æ­£ç‰ˆï¼‰=====

// â‘  æ—¢å­˜ã® onclick / æ—¢å­˜ãƒªã‚¹ãƒŠãƒ¼ã®å½±éŸ¿ã‚’ç¢ºå®Ÿã«æ¶ˆã™ï¼ˆå£Šã•ãªã„ä¿é™ºï¼‰
    let startBtn = document.getElementById("startPractice");
    if (startBtn) {
    const clean = startBtn.cloneNode(true);
    startBtn.parentNode.replaceChild(clean, startBtn);
    startBtn = clean;

    startBtn.addEventListener("click", () => {

    // â˜… ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€ŒpracticeGroupã€ã ã‘ã‚’è¦‹ã‚‹ï¼ˆpracticeCount ãªã©ã‚’æ··ãœãªã„ï¼‰
    const group = document.querySelector('#practiceSetup input[name="practiceGroup"]:checked')?.value;

    if (!group) {
      alert("ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’é¸ã‚“ã§ãã ã•ã„");
      return;
    }

    window.practiceConfig = {
      groups: [group],   // â† 1ã¤ã ã‘
      count: 10
    };

    window.practiceMode = true;

    document.getElementById("practiceSetup").style.display = "none";
    document.getElementById("testView").style.display = "block";

    startPractice();
  });

}

// ===== å¼·åŒ–ç·´ç¿’ END =====
/* â˜…â˜…â˜…â˜…â˜… ã“ã“ã‹ã‚‰è¿½åŠ  â˜…â˜…â˜…â˜…â˜… */

/* ===== å¿œç”¨ç·´ç¿’ æœ¬ä½“ ===== */
 // ===== å¿œç”¨ç·´ç¿’ START =====
// ===== å¿œç”¨ç·´ç¿’ END =====

let appliedQuestions = [];
let appliedIndex = 0;
let appliedSelected = null;
let appliedBlockCorrect = 0; // â˜… 3å•ãƒ–ãƒ­ãƒƒã‚¯å†…ã®æ­£è§£æ•°

let isAppliedBlockReview = false;
let appliedReviewData = null; 
let isAppliedFinished = false; // â† â˜…ã“ã‚Œ

const APPLIED_FEEDBACK_TEXT = {
  ja: {
    correct: "æ­£è§£ã€‚",
    wrong: "ä¸æ­£è§£ã€‚",
    explain: "æ–‡æ³•ã®èª¬æ˜ã‚’è¦‹ã‚‹",
    next: "æ¬¡ã¸"
  },
  en: {
    correct: "Correct.",
    wrong: "Incorrect.",
    explain: "View grammar explanation",
    next: "Next"
  },
  de: {
    correct: "Richtig.",
    wrong: "Falsch.",
    explain: "GrammatikerklÃ¤rung anzeigen",
    next: "Weiter"
  },
  ko: {
    correct: "ì •ë‹µì…ë‹ˆë‹¤.",
    wrong: "ì˜¤ë‹µì…ë‹ˆë‹¤.",
    explain: "ë¬¸ë²• ì„¤ëª… ë³´ê¸°",
    next: "ë‹¤ìŒ"
  }
};

const APPLIED_REVIEW_COMMENTS = {
  3: {
    ja: "ã‚ˆãã§ãã¦ã„ã‚‹ã€‚ã—ã£ã‹ã‚Šç†è§£ã§ãã¦ã„ã¾ã™ã€‚",
    en: "Well done. You understand this well.",
    de: "Gut gemacht. Du hast das gut verstanden.",
    ko: "ì•„ì£¼ ì˜í–ˆì–´ìš”. ì˜ ì´í•´í•˜ê³  ìˆìŠµë‹ˆë‹¤."
  },
  2: {
    ja: "ã ã„ã¶ã„ã„ã§ã™ã€‚ã‚ã¨å°‘ã—ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚",
    en: "Pretty good. Let's check it once more.",
    de: "Schon sehr gut. Schau es dir noch einmal kurz an.",
    ko: "ê½¤ ì˜í–ˆì–´ìš”. ì¡°ê¸ˆë§Œ ë” í™•ì¸í•´ ë´…ì‹œë‹¤."
  },
  1: {
    ja: "ã‚‚ã†å°‘ã—å¾©ç¿’ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\nä¾‹æ–‡ã‚’è¦‹ç›´ã™ã¨ã€ç†è§£ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚",
    en: "Let's review a bit more.\nLooking at example sentences will help.",
    de: "Lass uns noch etwas wiederholen.\nBeispiele helfen beim VerstÃ¤ndnis.",
    ko: "ì¡°ê¸ˆ ë” ë³µìŠµí•´ ë´…ì‹œë‹¤.\nì˜ˆë¬¸ì„ ë³´ë©´ ì´í•´í•˜ê¸° ì‰¬ì›Œì§‘ë‹ˆë‹¤."
  },
  0: {
    ja: "å¤§ä¸ˆå¤«ã€‚ä»Šã¯ç¢ºèªã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‚\nç„¦ã‚‰ãšä¸€ã¤ãšã¤è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚",
    en: "It's okay. This is a good time to check.\nTake it one step at a time.",
    de: "Kein Problem. Jetzt ist Zeit zum ÃœberprÃ¼fen.\nGehe Schritt fÃ¼r Schritt vor.",
    ko: "ê´œì°®ì•„ìš”. ì§€ê¸ˆì€ í™•ì¸í•˜ëŠ” ë‹¨ê³„ì˜ˆìš”.\nì²œì²œíˆ í•˜ë‚˜ì”© ë´…ì‹œë‹¤."
  }
};

// 20å•ã«å›ºå®šã—ã¦èª­ã‚€
function loadAppliedQuestions() {
  return fetch("questions_applied.json")
    .then(r => {
      if (!r.ok) throw new Error("Fetch failed: " + r.status);
      return r.json();
    })
    .then(data => {
      const arr = data.questions ?? data;
      appliedQuestions = Array.isArray(arr) ? arr.slice() : [];
      appliedQuestions.sort(() => Math.random() - 0.5); // ã‚·ãƒ£ãƒƒãƒ•ãƒ«
      appliedQuestions = appliedQuestions.slice(0, 20); // â˜… 20å•
      appliedIndex = 0;
      appliedSelected = null;
    });
}
function shuffleAppliedChoices(q) {
  const pairs = (q?.choices ?? []).map((text, idx) => ({ text, idx }));

  for (let i = pairs.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [pairs[i], pairs[j]] = [pairs[j], pairs[i]];
  }

  return {
    choices: pairs.map(p => p.text),
    answer: pairs.findIndex(p => p.idx === q.answer)
  };
}
function showAppliedQuestion() {
  if (isAppliedFinished) return; // â˜…ã“ã“// â˜… 3å•ã”ã¨ã®æŒ¯ã‚Šè¿”ã‚Šç”»é¢

  // nextãƒœã‚¿ãƒ³ã‚’ã€Œæ¬¡ã¸ã€ã¨ã—ã¦ä½¿ç”¨
  nextBtn.style.display = "inline-block";
  nextBtn.disabled = true; 
  nextBtn.textContent =
  (APPLIED_FEEDBACK_TEXT[currentLang] ?? APPLIED_FEEDBACK_TEXT.ja).next;

  appliedSelected = null;


  const q = appliedQuestions[appliedIndex];
 
  // çµ‚äº†
  if (!q) {
    isAppliedFinished = true;   // â˜…ã“ã‚Œ
    appliedSelected = null; // â˜…ã“ã‚Œã‚’è¿½åŠ 

   qEl.innerHTML =
    "ãŠã¤ã‹ã‚Œã•ã¾ã§ã—ãŸã€‚<br>" +
    "ã“ã‚Œã§N5ã®æ–‡æ³•ç·´ç¿’ã¯ãŠã‚ã‚Šã¾ã—ãŸã€‚<br>" +
    "æ¬¡ã¯ã€N4ã®æ–‡æ³•ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚<br><br>" +
    "<span style='font-size:14px; color:#666;'>"
    + "Well done!<br>"
    + "You have finished the N5 grammar practice.<br>"
    + "Next, letâ€™s move on to N4 grammar practice."
    + "</span>";

  choicesEl.innerHTML = "";
  nextBtn.style.display = "none";
  progressEl.textContent = "20 / 20";
  statusEl.textContent = "";
  return;
}
// â˜… â‘¢ çµ‚äº†ã§ãªã„ã¨ãã ã‘ã‚·ãƒ£ãƒƒãƒ•ãƒ«
const shuffled = shuffleAppliedChoices(q);
  q._shuffledAnswer = shuffled.answer;
  // ä¸Šéƒ¨è¡¨ç¤º
  modePill.textContent = "å¿œç”¨ç·´ç¿’";
  statusEl.textContent = "å¿œç”¨ç·´ç¿’ï¼ˆ20å•ï¼‰";
  progressEl.textContent = `${appliedIndex + 1} / 20`;
  groupPill.textContent = "â€”";
  typePill.textContent = "ä¸‰æŠ / Applied";

  // å•é¡Œæ–‡
  qEl.textContent = q.question ?? "ï¼ˆå•é¡Œæ–‡ãªã—ï¼‰";

  // é¸æŠè‚¢ï¼‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯é ˜åŸŸ
  choicesEl.innerHTML = "";
  const fb = document.createElement("div");
  fb.id = "appliedFeedback";
  fb.style.marginTop = "10px";
  fb.style.fontSize = "14px";
  fb.style.lineHeight = "1.6";
  choicesEl.appendChild(fb);


  // é¸æŠè‚¢æç”»
  (shuffled.choices ?? []).forEach((c, i) => {
    const d = document.createElement("div");
    d.className = "choice";
    d.textContent = c;

    d.onclick = () => {
     // äºŒé‡ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢
     if (appliedSelected !== null) return;

     document.querySelectorAll(".choice").forEach(x => x.classList.remove("selected"));
     d.classList.add("selected");
     appliedSelected = i;
     nextBtn.disabled = false;

     const correct = (i === q._shuffledAnswer);

     // æ­£è§£æ•°ã‚«ã‚¦ãƒ³ãƒˆï¼ˆ3å•åŒºåˆ‡ã‚Šç”¨ï¼‰
     if (correct) 
      appliedBlockCorrect++;

     // â‘  æ­£èª¤è¡¨ç¤ºã ã‘å…ˆã«å‡ºã™
     const FT = APPLIED_FEEDBACK_TEXT[currentLang] ?? APPLIED_FEEDBACK_TEXT.ja;

     fb.innerHTML = correct
     ? `<div class="good" style="font-weight:700;">${FT.correct}</div>`
     : `<div class="bad" style="font-weight:700;">${FT.wrong}</div>`;

     // â‘¡ æ–‡æ³•èª¬æ˜ãƒœã‚¿ãƒ³ï¼ˆæ­£è§£ãƒ»ä¸æ­£è§£ã©ã¡ã‚‰ã§ã‚‚è¡¨ç¤ºï¼‰
     const explainBtn= document.createElement("button");
     explainBtn.textContent =
       (APPLIED_FEEDBACK_TEXT[currentLang] ?? APPLIED_FEEDBACK_TEXT.ja).explain;

     explainBtn.style.marginTop = "8px";
     explainBtn.style.fontSize = "13px";

     explainBtn.onclick = () => {
       // ã™ã§ã«è¡¨ç¤ºæ¸ˆã¿ãªã‚‰ä½•ã‚‚ã—ãªã„
       if (explainBtn._shown) return;
       explainBtn._shown = true;

       const expl =
         q.explanation?.[currentLang]
         ?? q.explanation?.ja
         ?? "ï¼ˆè§£èª¬ã¯æœªç™»éŒ²ï¼‰";

     const explBox = document.createElement("div");
     explBox.style.marginTop = "8px";
     explBox.style.whiteSpace = "pre-line";
     explBox.style.fontSize = "14px";
     explBox.textContent = expl;

     currentExplanationQuestion = q;
     currentExplanationBox = explBox;

     fb.appendChild(explBox);
     explainBtn.disabled = true; // æŠ¼ã›ãªã„ã ã‘ã«ã™ã‚‹
  };

  fb.appendChild(explainBtn);

  // â‘¢ æ¬¡ã¸ãƒœã‚¿ãƒ³ã¯å¸¸ã«ä½¿ãˆã‚‹
   nextBtn.textContent =
   (APPLIED_FEEDBACK_TEXT[currentLang] ?? APPLIED_FEEDBACK_TEXT.ja).next;

};

    // fbã‚ˆã‚Šä¸Šã«ç©ã‚€ãŸã‚ã€fbã®å‰ã«æŒ¿å…¥
    choicesEl.insertBefore(d, fb);
  });

  // æ¬¡ã¸ï¼ˆ1å›ã ã‘ãƒã‚¤ãƒ³ãƒ‰ï¼‰
 nextBtn.onclick = () => {
    if (appliedSelected === null) return;

    appliedIndex++;

  // 3å•çµ‚ã‚ã£ãŸç›´å¾Œã«æŒ¯ã‚Šè¿”ã‚Šï¼ˆãŸã ã—æœ€å¾Œã®å•é¡Œå¾Œã¯ä¸è¦ï¼‰
  if (appliedIndex % 3 === 0 && appliedIndex < appliedQuestions.length) {
   isAppliedReviewScreen = true;
   appliedReviewData = { correct: appliedBlockCorrect };

   appliedBlockCorrect = 0;
   redrawAppliedReview();
   return;
}  

    isAppliedReviewScreen = false;
    showAppliedQuestion();
  };
}
// â˜…ã“ã‚Œã‚’å¿…ãšæ®‹ã™ï¼ˆ1å•ç›®ãƒ»2å•ç›®ç”¨ï¼‰
// â˜…ã“ã“ãŒæ­£è§£ï¼ˆshowAppliedQuestion ã®ç›´å¾Œï¼‰
function redrawAppliedReview() {
  if (!appliedReviewData) return;

  const T = APPLIED_REVIEW_TEXT[currentLang] ?? APPLIED_REVIEW_TEXT.ja;
  const n = appliedReviewData.correct;

  qEl.textContent = T.title;
  choicesEl.innerHTML = "";

  choicesEl.insertAdjacentHTML(
    "beforeend",
    `<div style="font-weight:600; margin-bottom:8px;">${T.score(n)}</div>`
  );

  const msg =
    n >= 3 ? T.c3 :
    n === 2 ? T.c2 : T.c1;

  const box = document.createElement("div");
  box.style.whiteSpace = "pre-line";
  box.style.fontSize = "16px";
  box.style.lineHeight = "1.8";
  box.textContent = msg;
  choicesEl.appendChild(box);

  nextBtn.textContent = T.next3;
  nextBtn.disabled = false;

  
}

// â˜…ã“ã‚Œã‚’å¿…ãšæ®‹ã™ï¼ˆ1å•ç›®ãƒ»2å•ç›®ç”¨ï¼‰  
/* å¿œç”¨ç·´ç¿’ãƒœã‚¿ãƒ³ */
const startAppliedBtn = document.getElementById("startAppliedPractice");
if (startAppliedBtn) {
  startAppliedBtn.onclick = async () => {
    document.getElementById("practiceSetup").style.display = "none";
    document.getElementById("testView").style.display = "block";

    window.practiceMode = "APPLIED";

     // â˜… é€šå¸¸ç·´ç¿’ã®çŠ¶æ…‹ã‚’å®Œå…¨ãƒªã‚»ãƒƒãƒˆï¼ˆâ† é‡è¦ï¼‰
    current = 0;
    questions = [];
    selectedIndex = null;
    nextBtn.onclick = null;

    testView.style.display = "block";
    resultView.style.display = "none";

    // å¿œç”¨ç·´ç¿’é–‹å§‹æ™‚ã«åˆæœŸåŒ–ï¼ˆè¨ºæ–­ã‚„å¼·åŒ–ç·´ç¿’ã¨æ··ã–ã‚‰ãªã„ã‚ˆã†ã«ï¼‰
    results = [];

    await loadAppliedQuestions();
    showAppliedQuestion();
  };
}
 
/* â˜…â˜…â˜…â˜…â˜… ã“ã“ã¾ã§ â˜…â˜…â˜…â˜…â˜… */

   // ğŸŒ è¨€èªãƒœã‚¿ãƒ³ï¼ˆDOMå¾Œã«è¨­å®šï¼‰
   // 
document.getElementById("btn-ja").onclick = () => {
  setLang("ja");
  if (
    window.practiceMode === "APPLIED" &&
    isAppliedReviewScreen === true &&
    appliedReviewData
  ) {
    redrawAppliedReview();
  }
};

document.getElementById("btn-en").onclick = () => {
  setLang("en");
  if (
    window.practiceMode === "APPLIED" &&
    isAppliedReviewScreen === true &&
    appliedReviewData
  ) {
    redrawAppliedReview();
  }
};

document.getElementById("btn-de").onclick = () => {
  setLang("de");
  if (
    window.practiceMode === "APPLIED" &&
    isAppliedReviewScreen === true &&
    appliedReviewData
  ) {
    redrawAppliedReview();
  }   
};

document.getElementById("btn-ko").onclick = () => {
  setLang("ko");
  if (
    window.practiceMode === "APPLIED" &&
    isAppliedReviewScreen === true &&
    appliedReviewData
  ) {
    redrawAppliedReview();
  }
}; 


 // â˜… ã“ã“ã ã‘ãŒä¿®æ­£ãƒã‚¤ãƒ³ãƒˆ
 // DOMãŒæƒã£ã¦ã‹ã‚‰è¨€èªã‚’åæ˜ 
   if (typeof setLang === "function") {
     setLang(currentLang);
  }
   
});
</script>
 
</body>
</html>